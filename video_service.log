2025-03-05 23:07:06,448 - INFO - Запуск приложения и инициализация базы данных...
2025-03-05 23:07:06,448 - DEBUG - Начало инициализации базы данных...
2025-03-05 23:07:06,463 - INFO - Запуск подписки на канал Redis для получения задач
2025-03-05 23:07:06,470 - INFO - Redis доступен.
2025-03-05 23:07:06,470 - INFO - Проверка соединения с AWS S3...
2025-03-05 23:07:06,488 - INFO - База данных успешно инициализирована.
2025-03-05 23:07:06,488 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-03-05 23:07:06,488 - INFO - Директория уже существует: ./video_temp
2025-03-05 23:07:06,488 - INFO - Директория уже существует: ./image_temp
2025-03-05 23:07:06,488 - INFO - Директория уже существует: ./output_video
2025-03-05 23:07:06,488 - INFO - Директория уже существует: ./output_preview
2025-03-05 23:07:06,489 - INFO - Директория уже существует: ./user_logo
2025-03-05 23:07:06,490 - INFO - Задача fetch_and_cache_profiles добавлена в расписание (каждые 5 минут).
2025-03-05 23:07:06,490 - INFO - Задача sync_data_to_db добавлена в расписание (каждые 8 минут).
2025-03-05 23:07:06,490 - INFO - Задача очистки логов добавлена в расписание (каждые 5 минут).
2025-03-05 23:07:06,490 - INFO - Задача очистки временных файлов добавлена в расписание (каждый день в 00:00).
2025-03-05 23:07:06,490 - INFO - Планировщик задач успешно запущен.
2025-03-05 23:07:06,940 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-05 23:07:06,941 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-05 23:07:06,941 - INFO - Подключаемся к Redis...
2025-03-05 23:07:06,942 - INFO - Подписались на канал video_tasks
2025-03-05 23:07:28,483 - INFO - Открытие сессии с БД...
2025-03-05 23:07:28,502 - INFO - Сессия с БД успешно открыта.
2025-03-05 23:07:28,534 - INFO - Начало хеширования номера кошелька.
2025-03-05 23:07:28,535 - INFO - Хеш номера кошелька: 687e1adfcafc7deae7d01f1279313058c5d41b23d5d92430d84d847ef93e16b9
2025-03-05 23:07:28,535 - INFO - Поиск пользователя в базе данных.
2025-03-05 23:07:28,576 - INFO - Пользователь найден с ID 938
2025-03-05 23:07:28,670 - INFO - Попытка получить избранное из кэша Redis.
2025-03-05 23:07:28,680 - INFO - Нет избранных профилей в кэше для пользователя 938.
2025-03-05 23:07:28,680 - INFO - Избранное не найдено в кэше. Загружаем из базы данных.
2025-03-05 23:07:28,683 - INFO - Избранное загружено из БД: []
2025-03-05 23:07:28,683 - INFO - Генерация токенов для пользователя.
2025-03-05 23:07:28,684 - INFO - Токены успешно сгенерированы.
2025-03-05 23:07:28,685 - INFO - Закрытие сессии с БД.
2025-03-05 23:08:23,752 - INFO - Получены данные профиля: {'name': 'Заебал этот эндпоинт сука!', 'website_or_social': 'https://twitter.com/johndoe', 'activity_hobbies': 'Gaming, Traveling', 'hashtags': None, 'adress': ['123 Example Street, Example City', '456 Another Street, Another City'], 'city': 'нахуй все', 'coordinates': [(59.77, 37.68)], 'is_in_mlm': 1, 'is_incognito': False, 'wallet_number': '0x27b0B8cfa07fA60f36Ad953F679D36EBC7d4355', 'language': None}
2025-03-05 23:08:23,753 - INFO - Получены данные о изображении: {'image_path': './image_temp/89ee3bcd-31c3-40f3-8dd9-4717aca81821_orig_cat.webp'}
2025-03-05 23:08:23,759 - INFO - Открытие сессии с БД...
2025-03-05 23:08:23,760 - INFO - Сессия с БД успешно открыта.
2025-03-05 23:08:23,775 - INFO - Обновлен профиль пользователя 938, is_admin сохранен: False
2025-03-05 23:08:23,790 - INFO - Профиль успешно сохранен.
2025-03-05 23:08:23,790 - INFO - Закрытие сессии с БД.
2025-03-05 23:12:06,503 - INFO - Открытие сессии с БД...
2025-03-05 23:12:06,508 - INFO - Сессия с БД успешно открыта.
2025-03-05 23:12:06,585 - INFO - Логи старше 10 минут и строки с неправильным форматом удалены из файла video_service.log.
2025-03-05 23:12:06,907 - INFO - Успешно обработано и закэшировано 911 профилей в Redis.
2025-03-05 23:12:06,968 - INFO - Всего публичных профилей в кеше: 489
2025-03-05 23:12:06,969 - INFO - Собрано уникальных профилей по алгоритму: 42
2025-03-05 23:12:06,969 - INFO - Добавляем 8 случайных профилей из оставшихся.
2025-03-05 23:12:06,970 - INFO - Сформировано страниц: 10
2025-03-05 23:12:06,972 - INFO - В кэше размещено 10 страниц.
2025-03-05 23:12:06,973 - INFO - Сформировано и закэшировано 10 страниц из 489 профилей.
2025-03-05 23:12:06,973 - INFO - Закрытие сессии с БД.
2025-03-05 23:13:08,245 - ERROR - Ошибка при получении сообщения: Connection closed by server.
Module: __main__, Function: main, Line: 168
2025-03-05 23:14:48,596 - INFO - Запуск приложения и инициализация базы данных...
2025-03-05 23:14:48,597 - DEBUG - Начало инициализации базы данных...
2025-03-05 23:14:48,707 - INFO - Запуск подписки на канал Redis для получения задач
2025-03-05 23:14:48,714 - INFO - Redis доступен.
2025-03-05 23:14:48,714 - INFO - Проверка соединения с AWS S3...
2025-03-05 23:14:48,722 - INFO - База данных успешно инициализирована.
2025-03-05 23:14:48,722 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-03-05 23:14:48,722 - INFO - Директория уже существует: ./video_temp
2025-03-05 23:14:48,723 - INFO - Директория уже существует: ./image_temp
2025-03-05 23:14:48,723 - INFO - Директория уже существует: ./output_video
2025-03-05 23:14:48,723 - INFO - Директория уже существует: ./output_preview
2025-03-05 23:14:48,723 - INFO - Директория уже существует: ./user_logo
2025-03-05 23:14:48,731 - INFO - Задача fetch_and_cache_profiles добавлена в расписание (каждые 5 минут).
2025-03-05 23:14:48,731 - INFO - Задача sync_data_to_db добавлена в расписание (каждые 8 минут).
2025-03-05 23:14:48,731 - INFO - Задача очистки логов добавлена в расписание (каждые 5 минут).
2025-03-05 23:14:48,732 - INFO - Задача очистки временных файлов добавлена в расписание (каждый день в 00:00).
2025-03-05 23:14:48,733 - INFO - Планировщик задач успешно запущен.
2025-03-05 23:14:49,175 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-05 23:14:49,176 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-05 23:14:49,176 - INFO - Подключаемся к Redis...
2025-03-05 23:14:49,177 - INFO - Подписались на канал video_tasks
2025-03-05 23:15:30,190 - INFO - Открытие сессии с БД...
2025-03-05 23:15:30,193 - INFO - Сессия с БД успешно открыта.
2025-03-05 23:15:30,244 - INFO - Начало хеширования номера кошелька.
2025-03-05 23:15:30,245 - INFO - Хеш номера кошелька: 687e1adfcafc7deae7d01f1279313058c5d41b23d5d92430d84d847ef93e16b9
2025-03-05 23:15:30,245 - INFO - Поиск пользователя в базе данных.
2025-03-05 23:15:30,313 - INFO - Пользователь найден с ID 938
2025-03-05 23:15:30,487 - INFO - Попытка получить избранное из кэша Redis.
2025-03-05 23:15:30,496 - INFO - Нет избранных профилей в кэше для пользователя 938.
2025-03-05 23:15:30,496 - INFO - Избранное не найдено в кэше. Загружаем из базы данных.
2025-03-05 23:15:30,500 - INFO - Избранное загружено из БД: []
2025-03-05 23:15:30,501 - INFO - Генерация токенов для пользователя.
2025-03-05 23:15:30,503 - INFO - Токены успешно сгенерированы.
2025-03-05 23:15:30,503 - INFO - Закрытие сессии с БД.
2025-03-05 23:16:37,635 - INFO - Получены данные профиля: {'name': 'Заебал этот эндпоинт сука!', 'website_or_social': 'https://twitter.com/johndoe', 'activity_hobbies': 'Gaming, Traveling', 'hashtags': None, 'adress': ['123 Example Street, Example City', '456 Another Street, Another City'], 'city': 'ЕБАШУ В КАШУ', 'coordinates': [(59.77, 37.68)], 'is_in_mlm': 1, 'is_incognito': False, 'wallet_number': '0x27b0B8cfa07fA60f36Ad953F679D36EBC7d4355', 'language': None}
2025-03-05 23:16:37,637 - INFO - Получены данные о изображении: {'image_path': './image_temp/89ee3bcd-31c3-40f3-8dd9-4717aca81821_orig_cat.webp'}
2025-03-05 23:16:37,644 - INFO - Открытие сессии с БД...
2025-03-05 23:16:37,644 - INFO - Сессия с БД успешно открыта.
2025-03-05 23:16:37,659 - INFO - Обновлен профиль пользователя 938, is_admin сохранен: False
2025-03-05 23:16:37,679 - INFO - Профиль успешно обновлен.
2025-03-05 23:16:37,680 - INFO - Закрытие сессии с БД.
2025-03-05 23:16:50,537 - ERROR - Ошибка при получении сообщения: Connection closed by server.
Module: __main__, Function: main, Line: 168
2025-03-05 23:17:37,531 - INFO - Запуск подписки на канал Redis для получения задач
2025-03-05 23:17:37,562 - INFO - Redis доступен.
2025-03-05 23:17:37,562 - INFO - Проверка соединения с AWS S3...
2025-03-05 23:17:37,748 - INFO - Запуск приложения и инициализация базы данных...
2025-03-05 23:17:37,748 - DEBUG - Начало инициализации базы данных...
2025-03-05 23:17:37,807 - INFO - База данных успешно инициализирована.
2025-03-05 23:17:37,807 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-03-05 23:17:37,807 - INFO - Директория уже существует: ./video_temp
2025-03-05 23:17:37,807 - INFO - Директория уже существует: ./image_temp
2025-03-05 23:17:37,808 - INFO - Директория уже существует: ./output_video
2025-03-05 23:17:37,808 - INFO - Директория уже существует: ./output_preview
2025-03-05 23:17:37,808 - INFO - Директория уже существует: ./user_logo
2025-03-05 23:17:37,815 - INFO - Задача fetch_and_cache_profiles добавлена в расписание (каждые 5 минут).
2025-03-05 23:17:37,815 - INFO - Задача sync_data_to_db добавлена в расписание (каждые 8 минут).
2025-03-05 23:17:37,815 - INFO - Задача очистки логов добавлена в расписание (каждые 5 минут).
2025-03-05 23:17:37,816 - INFO - Задача очистки временных файлов добавлена в расписание (каждый день в 00:00).
2025-03-05 23:17:37,816 - INFO - Планировщик задач успешно запущен.
2025-03-05 23:17:37,964 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-05 23:17:37,964 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-05 23:17:37,965 - INFO - Подключаемся к Redis...
2025-03-05 23:17:37,965 - INFO - Подписались на канал video_tasks
2025-03-05 23:17:54,334 - ERROR - Ошибка при получении сообщения: Connection closed by server.
Module: __main__, Function: main, Line: 168
2025-03-05 23:31:45,768 - INFO - Запуск подписки на канал Redis для получения задач
2025-03-05 23:31:45,778 - INFO - Redis доступен.
2025-03-05 23:31:45,778 - INFO - Проверка соединения с AWS S3...
2025-03-05 23:31:45,914 - INFO - Запуск приложения и инициализация базы данных...
2025-03-05 23:31:45,915 - DEBUG - Начало инициализации базы данных...
2025-03-05 23:31:45,969 - INFO - База данных успешно инициализирована.
2025-03-05 23:31:45,969 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-03-05 23:31:45,969 - INFO - Директория уже существует: ./video_temp
2025-03-05 23:31:45,969 - INFO - Директория уже существует: ./image_temp
2025-03-05 23:31:45,969 - INFO - Директория уже существует: ./output_video
2025-03-05 23:31:45,969 - INFO - Директория уже существует: ./output_preview
2025-03-05 23:31:45,969 - INFO - Директория уже существует: ./user_logo
2025-03-05 23:31:45,971 - INFO - Задача fetch_and_cache_profiles добавлена в расписание (каждые 5 минут).
2025-03-05 23:31:45,971 - INFO - Задача sync_data_to_db добавлена в расписание (каждые 8 минут).
2025-03-05 23:31:45,971 - INFO - Задача очистки логов добавлена в расписание (каждые 5 минут).
2025-03-05 23:31:45,971 - INFO - Задача очистки временных файлов добавлена в расписание (каждый день в 00:00).
2025-03-05 23:31:45,972 - INFO - Планировщик задач успешно запущен.
2025-03-05 23:31:46,223 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-05 23:31:46,224 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-05 23:31:46,224 - INFO - Подключаемся к Redis...
2025-03-05 23:31:46,225 - INFO - Подписались на канал video_tasks
2025-03-05 23:32:10,631 - ERROR - Ошибка при получении сообщения: Connection closed by server.
Module: __main__, Function: main, Line: 168
