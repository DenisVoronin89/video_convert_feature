2025-02-26 20:44:40,568 - INFO - Запуск подписки на канал Redis для получения задач
2025-02-26 20:44:40,576 - INFO - Redis доступен.
2025-02-26 20:44:40,577 - INFO - Подключаемся к Redis...
2025-02-26 20:44:40,577 - INFO - Подписались на канал video_tasks
2025-02-26 20:44:40,660 - INFO - Запуск приложения и инициализация базы данных...
2025-02-26 20:44:40,660 - DEBUG - Начало инициализации базы данных...
2025-02-26 20:44:40,728 - INFO - База данных успешно инициализирована.
2025-02-26 20:44:40,728 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-02-26 20:44:40,729 - INFO - Директория уже существует: ./video_temp
2025-02-26 20:44:40,729 - INFO - Директория уже существует: ./image_temp
2025-02-26 20:44:40,729 - INFO - Директория уже существует: ./output_video
2025-02-26 20:44:40,729 - INFO - Директория уже существует: ./output_preview
2025-02-26 20:44:40,729 - INFO - Директория уже существует: ./user_logo
2025-02-26 20:44:40,732 - INFO - Задача get_sorted_profiles добавлена в расписание (каждую минуту).
2025-02-26 20:44:40,732 - INFO - Планировщик задач успешно запущен.
2025-02-26 20:44:55,004 - INFO - Открытие сессии с БД...
2025-02-26 20:44:55,005 - INFO - Сессия с БД успешно открыта.
2025-02-26 20:44:55,019 - INFO - Начало хеширования номера кошелька.
2025-02-26 20:44:55,019 - INFO - Хеш номера кошелька: 49d48daaf566da9e569ccad832c772f1b81a91ed12c75c5c5692b3c34ee92bd5
2025-02-26 20:44:55,020 - INFO - Поиск пользователя в базе данных.
2025-02-26 20:44:55,058 - INFO - Пользователь не найден, создаем нового.
2025-02-26 20:44:55,077 - INFO - Создан новый пользователь с ID 172
2025-02-26 20:44:55,077 - INFO - Генерация токенов для пользователя.
2025-02-26 20:44:55,077 - INFO - Токены успешно сгенерированы.
2025-02-26 20:44:55,077 - ERROR - Ошибка при обработке запроса: 1 validation error for UserResponse
hashtags
  Field required [type=missing, input_value={'id': 172, 'profile': No...alIRU5CuTH7zDZ9GVtfWg')}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.10/v/missing
2025-02-26 20:44:55,077 - ERROR - Ошибка в контексте сессии: 400: Ошибка при обработке запроса.
2025-02-26 20:44:55,078 - INFO - Закрытие сессии с БД.
2025-02-26 20:45:40,740 - INFO - Открытие сессии с БД...
2025-02-26 20:45:40,745 - INFO - Сессия с БД успешно открыта.
2025-02-26 20:45:40,890 - INFO - Выбрано и получено 50 профилей.
2025-02-26 20:45:40,905 - INFO - Профили успешно закешированы в Redis.
2025-02-26 20:45:40,905 - INFO - Закрытие сессии с БД.
2025-02-26 20:45:41,944 - ERROR - Ошибка при получении сообщения: Connection closed by server.
2025-02-26 20:45:41,957 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:45:41,959 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:45:41,962 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:45:41,967 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:45:41,968 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:45:41,970 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:45:41,971 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:45:41,972 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:45:41,973 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:45:41,975 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:45:41,976 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:45:41,977 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:45:41,978 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:49:17,462 - INFO - Запуск подписки на канал Redis для получения задач
2025-02-26 20:49:17,492 - INFO - Redis доступен.
2025-02-26 20:49:17,493 - INFO - Подключаемся к Redis...
2025-02-26 20:49:17,494 - INFO - Подписались на канал video_tasks
2025-02-26 20:49:17,845 - INFO - Запуск приложения и инициализация базы данных...
2025-02-26 20:49:17,845 - DEBUG - Начало инициализации базы данных...
2025-02-26 20:49:17,989 - INFO - База данных успешно инициализирована.
2025-02-26 20:49:17,989 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-02-26 20:49:17,993 - INFO - Директория уже существует: ./video_temp
2025-02-26 20:49:17,993 - INFO - Директория уже существует: ./image_temp
2025-02-26 20:49:17,994 - INFO - Директория уже существует: ./output_video
2025-02-26 20:49:17,995 - INFO - Директория уже существует: ./output_preview
2025-02-26 20:49:17,996 - INFO - Директория уже существует: ./user_logo
2025-02-26 20:49:18,000 - INFO - Задача get_sorted_profiles добавлена в расписание (каждую минуту).
2025-02-26 20:49:18,002 - INFO - Планировщик задач успешно запущен.
2025-02-26 20:49:50,096 - INFO - Открытие сессии с БД...
2025-02-26 20:49:50,098 - INFO - Сессия с БД успешно открыта.
2025-02-26 20:49:50,098 - INFO - Открытие сессии с БД...
2025-02-26 20:49:50,099 - INFO - Сессия с БД успешно открыта.
2025-02-26 20:49:51,393 - ERROR - Ошибка в контексте сессии: 500: (sqlalchemy.dialects.postgresql.asyncpg.IntegrityError) <class 'asyncpg.exceptions.UniqueViolationError'>: duplicate key value violates unique constraint "favorites_pkey"
DETAIL:  Key (user_id, profile_id)=(23, 134) already exists.
[SQL: INSERT INTO favorites (user_id, profile_id) VALUES ($1::INTEGER, $2::INTEGER), ($3::INTEGER, $4::INTEGER), ($5::INTEGER, $6::INTEGER), ($7::INTEGER, $8::INTEGER), ($9::INTEGER, $10::INTEGER) RETURNING favorites.created_at, favorites.user_id, favorites.profile_id]
[parameters: (23, 41, 23, 293, 23, 100, 23, 57, 23, 134)]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2025-02-26 20:49:51,393 - INFO - Закрытие сессии с БД.
2025-02-26 20:49:51,395 - INFO - Закрытие сессии с БД.
2025-02-26 20:50:18,012 - INFO - Открытие сессии с БД...
2025-02-26 20:50:18,024 - INFO - Сессия с БД успешно открыта.
2025-02-26 20:50:18,197 - INFO - Выбрано и получено 50 профилей.
2025-02-26 20:50:18,221 - INFO - Профили успешно закешированы в Redis.
2025-02-26 20:50:18,221 - INFO - Закрытие сессии с БД.
2025-02-26 20:51:18,014 - INFO - Открытие сессии с БД...
2025-02-26 20:51:18,019 - INFO - Сессия с БД успешно открыта.
2025-02-26 20:51:18,079 - INFO - Выбрано и получено 50 профилей.
2025-02-26 20:51:18,101 - INFO - Профили успешно закешированы в Redis.
2025-02-26 20:51:18,101 - INFO - Закрытие сессии с БД.
2025-02-26 20:52:18,013 - INFO - Открытие сессии с БД...
2025-02-26 20:52:18,018 - INFO - Сессия с БД успешно открыта.
2025-02-26 20:52:18,112 - INFO - Выбрано и получено 50 профилей.
2025-02-26 20:52:18,117 - INFO - Профили успешно закешированы в Redis.
2025-02-26 20:52:18,117 - INFO - Закрытие сессии с БД.
2025-02-26 20:53:18,008 - INFO - Открытие сессии с БД...
2025-02-26 20:53:18,013 - INFO - Сессия с БД успешно открыта.
2025-02-26 20:53:18,122 - INFO - Выбрано и получено 50 профилей.
2025-02-26 20:53:18,127 - INFO - Профили успешно закешированы в Redis.
2025-02-26 20:53:18,127 - INFO - Закрытие сессии с БД.
2025-02-26 20:53:31,727 - ERROR - Ошибка при получении сообщения: Connection closed by server.
2025-02-26 20:53:31,751 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,755 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,756 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,757 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,758 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,759 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,760 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,762 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,763 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,765 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,766 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,767 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,769 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,769 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,770 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,771 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,772 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,773 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,774 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,774 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,777 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,779 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,780 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,782 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,782 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,783 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,785 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:53:31,787 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-26 20:54:16,828 - INFO - Запуск подписки на канал Redis для получения задач
2025-02-26 20:54:16,835 - INFO - Redis доступен.
2025-02-26 20:54:16,835 - INFO - Подключаемся к Redis...
2025-02-26 20:54:16,835 - INFO - Подписались на канал video_tasks
2025-02-26 20:54:16,893 - INFO - Запуск приложения и инициализация базы данных...
2025-02-26 20:54:16,894 - DEBUG - Начало инициализации базы данных...
2025-02-26 20:54:16,951 - INFO - База данных успешно инициализирована.
2025-02-26 20:54:16,951 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-02-26 20:54:16,951 - INFO - Директория уже существует: ./video_temp
2025-02-26 20:54:16,951 - INFO - Директория уже существует: ./image_temp
2025-02-26 20:54:16,951 - INFO - Директория уже существует: ./output_video
2025-02-26 20:54:16,951 - INFO - Директория уже существует: ./output_preview
2025-02-26 20:54:16,951 - INFO - Директория уже существует: ./user_logo
2025-02-26 20:54:16,953 - INFO - Задача get_sorted_profiles добавлена в расписание (каждую минуту).
2025-02-26 20:54:16,954 - INFO - Планировщик задач успешно запущен.
2025-02-26 20:55:06,094 - INFO - Открытие сессии с БД...
2025-02-26 20:55:06,096 - INFO - Сессия с БД успешно открыта.
2025-02-26 20:55:06,097 - INFO - Открытие сессии с БД...
2025-02-26 20:55:06,097 - INFO - Сессия с БД успешно открыта.
2025-02-26 20:55:08,964 - INFO - Закрытие сессии с БД.
2025-02-26 20:55:08,965 - INFO - Закрытие сессии с БД.
2025-02-26 20:55:16,963 - INFO - Открытие сессии с БД...
2025-02-26 20:55:16,967 - INFO - Сессия с БД успешно открыта.
2025-02-26 20:55:17,162 - INFO - Выбрано и получено 50 профилей.
2025-02-26 20:55:17,166 - INFO - Профили успешно закешированы в Redis.
2025-02-26 20:55:17,166 - INFO - Закрытие сессии с БД.
2025-02-26 20:56:09,301 - ERROR - Ошибка при получении сообщения: Connection closed by server.
2025-02-26 20:56:09,320 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,323 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,324 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,326 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,327 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,328 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,329 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,330 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,331 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,334 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,336 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,337 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,339 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,340 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,341 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,344 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,345 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-26 20:56:09,346 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
