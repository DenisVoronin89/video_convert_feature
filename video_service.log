2025-02-28 11:10:24,092 - INFO - Запуск подписки на канал Redis для получения задач
2025-02-28 11:10:24,099 - INFO - Redis доступен.
2025-02-28 11:10:24,099 - INFO - Подключаемся к Redis...
2025-02-28 11:10:24,099 - INFO - Подписались на канал video_tasks
2025-02-28 11:10:24,165 - INFO - Запуск приложения и инициализация базы данных...
2025-02-28 11:10:24,165 - DEBUG - Начало инициализации базы данных...
2025-02-28 11:10:24,235 - INFO - База данных успешно инициализирована.
2025-02-28 11:10:24,235 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-02-28 11:10:24,235 - INFO - Директория уже существует: ./video_temp
2025-02-28 11:10:24,235 - INFO - Директория уже существует: ./image_temp
2025-02-28 11:10:24,235 - INFO - Директория уже существует: ./output_video
2025-02-28 11:10:24,235 - INFO - Директория уже существует: ./output_preview
2025-02-28 11:10:24,235 - INFO - Директория уже существует: ./user_logo
2025-02-28 11:10:24,238 - INFO - Задача get_sorted_profiles добавлена в расписание (каждую минуту).
2025-02-28 11:10:24,238 - INFO - Задача fetch_and_cache_profiles добавлена в расписание (каждые 30 секунд).
2025-02-28 11:10:24,238 - INFO - Планировщик задач успешно запущен.
2025-02-28 11:10:54,245 - INFO - Открытие сессии с БД...
2025-02-28 11:10:54,249 - INFO - Сессия с БД успешно открыта.
2025-02-28 11:10:54,468 - INFO - Успешно обработано и закэшировано 758 профилей в Redis.
2025-02-28 11:10:54,469 - INFO - Закрытие сессии с БД.
2025-02-28 11:11:24,246 - INFO - Открытие сессии с БД...
2025-02-28 11:11:24,252 - INFO - Сессия с БД успешно открыта.
2025-02-28 11:11:24,274 - INFO - Открытие сессии с БД...
2025-02-28 11:11:24,274 - INFO - Сессия с БД успешно открыта.
2025-02-28 11:11:24,441 - INFO - Выбрано и получено 50 профилей.
2025-02-28 11:11:24,445 - INFO - Профили успешно закешированы в Redis.
2025-02-28 11:11:24,445 - INFO - Закрытие сессии с БД.
2025-02-28 11:11:24,505 - INFO - Успешно обработано и закэшировано 758 профилей в Redis.
2025-02-28 11:11:24,505 - INFO - Закрытие сессии с БД.
2025-02-28 11:11:54,245 - INFO - Открытие сессии с БД...
2025-02-28 11:11:54,249 - INFO - Сессия с БД успешно открыта.
2025-02-28 11:11:54,382 - INFO - Успешно обработано и закэшировано 758 профилей в Redis.
2025-02-28 11:11:54,382 - INFO - Закрытие сессии с БД.
2025-02-28 11:12:24,245 - INFO - Открытие сессии с БД...
2025-02-28 11:12:24,248 - INFO - Сессия с БД успешно открыта.
2025-02-28 11:12:24,259 - INFO - Открытие сессии с БД...
2025-02-28 11:12:24,259 - INFO - Сессия с БД успешно открыта.
2025-02-28 11:12:24,356 - INFO - Выбрано и получено 50 профилей.
2025-02-28 11:12:24,359 - INFO - Профили успешно закешированы в Redis.
2025-02-28 11:12:24,359 - INFO - Закрытие сессии с БД.
2025-02-28 11:12:24,423 - INFO - Успешно обработано и закэшировано 758 профилей в Redis.
2025-02-28 11:12:24,423 - INFO - Закрытие сессии с БД.
2025-02-28 11:12:54,246 - INFO - Открытие сессии с БД...
2025-02-28 11:12:54,250 - INFO - Сессия с БД успешно открыта.
2025-02-28 11:12:54,409 - INFO - Успешно обработано и закэшировано 758 профилей в Redis.
2025-02-28 11:12:54,409 - INFO - Закрытие сессии с БД.
2025-02-28 11:13:24,244 - INFO - Открытие сессии с БД...
2025-02-28 11:13:24,250 - INFO - Сессия с БД успешно открыта.
2025-02-28 11:13:24,267 - INFO - Открытие сессии с БД...
2025-02-28 11:13:24,268 - INFO - Сессия с БД успешно открыта.
2025-02-28 11:13:24,326 - INFO - Выбрано и получено 50 профилей.
2025-02-28 11:13:24,329 - INFO - Профили успешно закешированы в Redis.
2025-02-28 11:13:24,329 - INFO - Закрытие сессии с БД.
2025-02-28 11:13:24,392 - INFO - Успешно обработано и закэшировано 758 профилей в Redis.
2025-02-28 11:13:24,392 - INFO - Закрытие сессии с БД.
2025-02-28 11:13:54,245 - INFO - Открытие сессии с БД...
2025-02-28 11:13:54,249 - INFO - Сессия с БД успешно открыта.
2025-02-28 11:13:54,380 - INFO - Успешно обработано и закэшировано 758 профилей в Redis.
2025-02-28 11:13:54,380 - INFO - Закрытие сессии с БД.
2025-02-28 11:14:24,240 - INFO - Открытие сессии с БД...
2025-02-28 11:14:24,241 - INFO - Сессия с БД успешно открыта.
2025-02-28 11:14:24,248 - INFO - Открытие сессии с БД...
2025-02-28 11:14:24,248 - INFO - Сессия с БД успешно открыта.
2025-02-28 11:14:24,323 - INFO - Выбрано и получено 50 профилей.
2025-02-28 11:14:24,325 - INFO - Профили успешно закешированы в Redis.
2025-02-28 11:14:24,326 - INFO - Закрытие сессии с БД.
2025-02-28 11:14:24,387 - INFO - Успешно обработано и закэшировано 758 профилей в Redis.
2025-02-28 11:14:24,387 - INFO - Закрытие сессии с БД.
2025-02-28 11:14:25,687 - INFO - Открытие сессии с БД...
2025-02-28 11:14:25,687 - INFO - Сессия с БД успешно открыта.
2025-02-28 11:14:25,720 - INFO - Начало хеширования номера кошелька.
2025-02-28 11:14:25,720 - INFO - Хеш номера кошелька: 870481d311cf9c35221d181797fc30af633589968607b4fb8555570efa69dfbf
2025-02-28 11:14:25,720 - INFO - Поиск пользователя в базе данных.
2025-02-28 11:14:25,734 - INFO - Пользователь найден с ID 155
2025-02-28 11:14:25,739 - INFO - Попытка получить избранное из кэша Redis.
2025-02-28 11:14:25,743 - INFO - Получены избранные профили для пользователя 155: [23, 33, 31]
2025-02-28 11:14:25,744 - INFO - Все 3 профилей найдены в Redis.
2025-02-28 11:14:25,744 - INFO - Избранное получено из кэша: [{'id': 23, 'name': 'Jeffrey Bell', 'user_logo_url': 'https://fakeurl.com/0fd309be-cdf3-4f71-807a-1da049428fdb.jpg', 'video_url': 'https://fakevideo.com/16729ce2-4e52-4c8f-a07b-ea680553c474.mp4', 'preview_url': None, 'activity_and_hobbies': 'Activity point defense market. Wear fine foreign treat body toward Mrs. Manager long fly country not.\nUs view operation fast learn language. Store including reality middle responsibility system.', 'is_moderated': False, 'is_incognito': True, 'is_in_mlm': 1, 'adress': [{'city': 'Roberttown', 'street': '2937 Simpson Meadows Suite 141'}], 'city': 'East Kathryn', 'coordinates': None, 'followers_count': 2, 'created_at': '2025-02-24T14:47:41.612932+00:00', 'hashtags': ['искусство', 'кулинария', 'программирование'], 'website_or_social': None, 'is_admin': False, 'language': 'gv'}, {'id': 33, 'name': 'Kelly Campbell', 'user_logo_url': 'https://fakeurl.com/bc639401-3217-466e-a357-22312f50222b.jpg', 'video_url': None, 'preview_url': 'https://fakevideo.com/1d660624-93a5-4de1-a402-a32577e080d0.jpg', 'activity_and_hobbies': None, 'is_moderated': True, 'is_incognito': True, 'is_in_mlm': 2, 'adress': [{'city': 'South Jeremychester', 'street': '45820 Smith Prairie'}], 'city': 'New Briannaberg', 'coordinates': None, 'followers_count': 1, 'created_at': '2025-02-24T14:47:41.657719+00:00', 'hashtags': ['кулинария', 'автомобили', 'природа'], 'website_or_social': None, 'is_admin': False, 'language': 'ro'}, {'id': 31, 'name': 'William Johnson', 'user_logo_url': 'https://fakeurl.com/ea033799-c4e0-4c0e-ac71-3d214ab94160.jpg', 'video_url': 'https://fakevideo.com/ad7aab12-4e9e-4381-8ca8-2f668892f9b6.mp4', 'preview_url': 'https://fakevideo.com/d32abdc9-2004-4ae5-8a18-7196cea7220b.jpg', 'activity_and_hobbies': 'Real ball test research language pull. Already size raise source. Situation sit process sea.', 'is_moderated': True, 'is_incognito': True, 'is_in_mlm': 0, 'adress': [{'city': 'North Samuelmouth', 'street': '397 Thomas Vista'}], 'city': None, 'coordinates': None, 'followers_count': 1, 'created_at': '2025-02-24T14:47:41.652769+00:00', 'hashtags': [], 'website_or_social': 'https://henry-leblanc.info/', 'is_admin': False, 'language': None}]
2025-02-28 11:14:25,744 - INFO - Генерация токенов для пользователя.
2025-02-28 11:14:25,746 - INFO - Токены успешно сгенерированы.
2025-02-28 11:14:25,746 - INFO - Закрытие сессии с БД.
2025-02-28 11:14:54,249 - INFO - Открытие сессии с БД...
2025-02-28 11:14:54,256 - INFO - Сессия с БД успешно открыта.
2025-02-28 11:14:54,434 - INFO - Успешно обработано и закэшировано 758 профилей в Redis.
2025-02-28 11:14:54,435 - INFO - Закрытие сессии с БД.
2025-02-28 11:15:19,097 - ERROR - Ошибка при получении сообщения: Connection closed by server.
2025-02-28 11:15:19,106 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,108 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,110 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,113 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,115 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,116 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,118 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,119 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,120 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,123 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,125 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,126 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,127 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,127 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,130 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,131 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,133 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,134 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,135 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,135 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,136 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,137 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,138 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,138 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,139 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,140 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,142 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,142 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,143 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
2025-02-28 11:15:19,145 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.2', 6379).
