2025-03-01 22:56:02,101 - INFO - Запуск подписки на канал Redis для получения задач
2025-03-01 22:56:02,109 - INFO - Redis доступен.
2025-03-01 22:56:02,109 - INFO - Подключаемся к Redis...
2025-03-01 22:56:02,109 - INFO - Подписались на канал video_tasks
2025-03-01 22:56:02,229 - INFO - Запуск приложения и инициализация базы данных...
2025-03-01 22:56:02,229 - DEBUG - Начало инициализации базы данных...
2025-03-01 22:56:02,296 - INFO - База данных успешно инициализирована.
2025-03-01 22:56:02,296 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-03-01 22:56:02,296 - INFO - Директория уже существует: ./video_temp
2025-03-01 22:56:02,296 - INFO - Директория уже существует: ./image_temp
2025-03-01 22:56:02,296 - INFO - Директория уже существует: ./output_video
2025-03-01 22:56:02,296 - INFO - Директория уже существует: ./output_preview
2025-03-01 22:56:02,297 - INFO - Директория уже существует: ./user_logo
2025-03-01 22:56:02,298 - INFO - Задача fetch_and_cache_profiles добавлена в расписание (каждые 30 секунд).
2025-03-01 22:56:02,298 - INFO - Задача sync_data_to_db добавлена в расписание (каждую минуту).
2025-03-01 22:56:02,299 - INFO - Задача очистки временных файлов добавлена в расписание (каждый день в 00:00).
2025-03-01 22:56:02,299 - INFO - Задача очистки логов добавлена в расписание (каждые 5 минут).
2025-03-01 22:56:02,299 - INFO - Планировщик задач успешно запущен.
2025-03-01 22:56:16,422 - INFO - Вызов get_all_profiles_from_cache с параметрами: user_id=126, ip_address=None
2025-03-01 22:56:16,423 - INFO - Вызов get_profiles_from_cashe_by_sorting_algorithm с параметрами: user_id=126, ip_address=None
2025-03-01 22:56:16,427 - WARNING - Кэш профилей пуст.
2025-03-01 22:56:16,427 - INFO - Кэш пуст, запрашиваем данные из базы данных.
2025-03-01 22:56:16,427 - INFO - Открытие сессии с БД...
2025-03-01 22:56:16,428 - INFO - Сессия с БД успешно открыта.
2025-03-01 22:56:16,428 - INFO - Запрос профилей: page=1, per_page=50, sort_by=None, user_id=126, ip_address=None
2025-03-01 22:56:16,430 - INFO - Получены 0 ID показанных профилей: []...
2025-03-01 22:56:16,446 - INFO - Случайная сортировка, страница 1
2025-03-01 22:56:16,590 - INFO - Найдено 50 профилей для страницы 1
2025-03-01 22:56:16,597 - INFO - Общее количество профилей (без учёта фильтров): 486
2025-03-01 22:56:16,597 - INFO - Закрытие сессии с БД.
2025-03-01 22:56:21,611 - INFO - Вызов get_all_profiles_from_cache с параметрами: user_id=126, ip_address=None
2025-03-01 22:56:21,614 - INFO - Вызов get_profiles_from_cashe_by_sorting_algorithm с параметрами: user_id=126, ip_address=None
2025-03-01 22:56:21,617 - WARNING - Кэш профилей пуст.
2025-03-01 22:56:21,618 - INFO - Кэш пуст, запрашиваем данные из базы данных.
2025-03-01 22:56:21,618 - INFO - Открытие сессии с БД...
2025-03-01 22:56:21,621 - INFO - Сессия с БД успешно открыта.
2025-03-01 22:56:21,621 - INFO - Запрос профилей: page=2, per_page=50, sort_by=None, user_id=126, ip_address=None
2025-03-01 22:56:21,625 - INFO - Получены 50 ID показанных профилей: [256, 769, 764, 390, 520, 650, 142, 275, 534, 285]...
2025-03-01 22:56:21,637 - INFO - Случайная сортировка, страница 2
2025-03-01 22:56:21,678 - INFO - Найдено 50 профилей для страницы 2
2025-03-01 22:56:21,681 - INFO - Общее количество профилей (без учёта фильтров): 486
2025-03-01 22:56:21,681 - INFO - Закрытие сессии с БД.
2025-03-01 22:56:28,071 - INFO - Вызов get_all_profiles_from_cache с параметрами: user_id=126, ip_address=None
2025-03-01 22:56:28,071 - INFO - Вызов get_profiles_from_cashe_by_sorting_algorithm с параметрами: user_id=126, ip_address=None
2025-03-01 22:56:28,072 - WARNING - Кэш профилей пуст.
2025-03-01 22:56:28,072 - INFO - Кэш пуст, запрашиваем данные из базы данных.
2025-03-01 22:56:28,072 - INFO - Открытие сессии с БД...
2025-03-01 22:56:28,072 - INFO - Сессия с БД успешно открыта.
2025-03-01 22:56:28,072 - INFO - Запрос профилей: page=3, per_page=50, sort_by=None, user_id=126, ip_address=None
2025-03-01 22:56:28,073 - INFO - Получены 100 ID показанных профилей: [1, 514, 3, 517, 520, 534, 22, 549, 41, 44]...
2025-03-01 22:56:28,074 - INFO - Случайная сортировка, страница 3
2025-03-01 22:56:28,096 - INFO - Найдено 50 профилей для страницы 3
2025-03-01 22:56:28,099 - INFO - Общее количество профилей (без учёта фильтров): 486
2025-03-01 22:56:28,099 - INFO - Закрытие сессии с БД.
2025-03-01 22:56:32,305 - INFO - Открытие сессии с БД...
2025-03-01 22:56:32,308 - INFO - Сессия с БД успешно открыта.
2025-03-01 22:56:32,637 - INFO - Успешно обработано и закэшировано 908 профилей в Redis.
2025-03-01 22:56:32,637 - INFO - Закрытие сессии с БД.
2025-03-01 22:57:02,306 - INFO - Открытие сессии с БД...
2025-03-01 22:57:02,309 - INFO - Сессия с БД успешно открыта.
2025-03-01 22:57:02,322 - INFO - Открытие сессии с БД...
2025-03-01 22:57:02,323 - INFO - Сессия с БД успешно открыта.
2025-03-01 22:57:02,438 - INFO - Закрытие сессии с БД.
2025-03-01 22:57:02,439 - INFO - Данные о избранном и счетчике подписчиков успешно синхронизированы из кеша в базу данных для всех пользователей.
2025-03-01 22:57:02,652 - INFO - Успешно обработано и закэшировано 908 профилей в Redis.
2025-03-01 22:57:02,653 - INFO - Закрытие сессии с БД.
2025-03-01 22:57:07,985 - INFO - Вызов get_all_profiles_from_cache с параметрами: user_id=178, ip_address=None
2025-03-01 22:57:07,988 - INFO - Вызов get_profiles_from_cashe_by_sorting_algorithm с параметрами: user_id=178, ip_address=None
2025-03-01 22:57:07,995 - INFO - Получены 0 ID показанных профилей: []...
2025-03-01 22:57:08,052 - INFO - Получено 43 профилей для страницы 1
2025-03-01 22:57:08,053 - INFO - Профили получены из кэша.
2025-03-01 22:57:13,895 - INFO - Вызов get_all_profiles_from_cache с параметрами: user_id=178, ip_address=None
2025-03-01 22:57:13,895 - INFO - Вызов get_profiles_from_cashe_by_sorting_algorithm с параметрами: user_id=178, ip_address=None
2025-03-01 22:57:13,902 - INFO - Получены 43 ID показанных профилей: [896, 897, 132, 901, 902, 383, 904, 265, 906, 905]...
2025-03-01 22:57:13,976 - INFO - Добавляем 50 случайных профилей из оставшихся.
2025-03-01 22:57:13,976 - INFO - Получено 50 профилей для страницы 2
2025-03-01 22:57:13,976 - INFO - Профили получены из кэша.
2025-03-01 22:57:21,893 - INFO - Вызов get_all_profiles_from_cache с параметрами: user_id=178, ip_address=None
2025-03-01 22:57:21,894 - INFO - Вызов get_profiles_from_cashe_by_sorting_algorithm с параметрами: user_id=178, ip_address=None
2025-03-01 22:57:21,901 - INFO - Получены 87 ID показанных профилей: [2, 516, 12, 27, 555, 44, 558, 47, 562, 565]...
2025-03-01 22:57:21,942 - INFO - Добавляем 50 случайных профилей из оставшихся.
2025-03-01 22:57:21,942 - INFO - Получено 50 профилей для страницы 3
2025-03-01 22:57:21,942 - INFO - Профили получены из кэша.
2025-03-01 22:57:28,435 - INFO - Вызов get_all_profiles_from_cache с параметрами: user_id=178, ip_address=None
2025-03-01 22:57:28,435 - INFO - Вызов get_profiles_from_cashe_by_sorting_algorithm с параметрами: user_id=178, ip_address=None
2025-03-01 22:57:28,440 - INFO - Получены 128 ID показанных профилей: [514, 2, 516, 5, 12, 27, 539, 555, 44, 558]...
2025-03-01 22:57:28,524 - INFO - Добавляем 50 случайных профилей из оставшихся.
2025-03-01 22:57:28,525 - INFO - Получено 50 профилей для страницы 9
2025-03-01 22:57:28,525 - INFO - Профили получены из кэша.
2025-03-01 22:57:32,305 - INFO - Открытие сессии с БД...
2025-03-01 22:57:32,306 - INFO - Сессия с БД успешно открыта.
2025-03-01 22:57:32,574 - INFO - Успешно обработано и закэшировано 908 профилей в Redis.
2025-03-01 22:57:32,575 - INFO - Закрытие сессии с БД.
2025-03-01 22:57:42,314 - INFO - Вызов get_all_profiles_from_cache с параметрами: user_id=178, ip_address=None
2025-03-01 22:57:42,318 - INFO - Вызов get_profiles_from_cashe_by_sorting_algorithm с параметрами: user_id=178, ip_address=None
2025-03-01 22:57:42,328 - INFO - Получены 169 ID показанных профилей: [514, 2, 516, 517, 5, 7, 10, 12, 26, 27]...
2025-03-01 22:57:42,427 - INFO - Добавляем 50 случайных профилей из оставшихся.
2025-03-01 22:57:42,429 - INFO - Получено 50 профилей для страницы 16
2025-03-01 22:57:42,429 - INFO - Профили получены из кэша.
2025-03-01 22:58:02,305 - INFO - Открытие сессии с БД...
2025-03-01 22:58:02,308 - INFO - Сессия с БД успешно открыта.
2025-03-01 22:58:02,320 - INFO - Открытие сессии с БД...
2025-03-01 22:58:02,320 - INFO - Сессия с БД успешно открыта.
2025-03-01 22:58:02,428 - INFO - Закрытие сессии с БД.
2025-03-01 22:58:02,429 - INFO - Данные о избранном и счетчике подписчиков успешно синхронизированы из кеша в базу данных для всех пользователей.
2025-03-01 22:58:02,620 - INFO - Успешно обработано и закэшировано 908 профилей в Redis.
2025-03-01 22:58:02,620 - INFO - Закрытие сессии с БД.
2025-03-01 22:58:32,306 - INFO - Открытие сессии с БД...
2025-03-01 22:58:32,322 - INFO - Сессия с БД успешно открыта.
2025-03-01 22:58:32,573 - INFO - Успешно обработано и закэшировано 908 профилей в Redis.
2025-03-01 22:58:32,573 - INFO - Закрытие сессии с БД.
2025-03-01 22:59:02,312 - INFO - Открытие сессии с БД...
2025-03-01 22:59:02,316 - INFO - Сессия с БД успешно открыта.
2025-03-01 22:59:02,338 - INFO - Открытие сессии с БД...
2025-03-01 22:59:02,338 - INFO - Сессия с БД успешно открыта.
2025-03-01 22:59:02,443 - INFO - Закрытие сессии с БД.
2025-03-01 22:59:02,444 - INFO - Данные о избранном и счетчике подписчиков успешно синхронизированы из кеша в базу данных для всех пользователей.
2025-03-01 22:59:02,636 - INFO - Успешно обработано и закэшировано 908 профилей в Redis.
2025-03-01 22:59:02,636 - INFO - Закрытие сессии с БД.
