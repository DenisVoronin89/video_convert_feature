2025-03-04 15:17:47,085 - INFO - Запуск подписки на канал Redis для получения задач
2025-03-04 15:17:47,094 - INFO - Redis доступен.
2025-03-04 15:17:47,094 - INFO - Подключаемся к Redis...
2025-03-04 15:17:47,094 - INFO - Подписались на канал video_tasks
2025-03-04 15:17:47,100 - INFO - Запуск приложения и инициализация базы данных...
2025-03-04 15:17:47,101 - DEBUG - Начало инициализации базы данных...
2025-03-04 15:17:47,232 - INFO - База данных успешно инициализирована.
2025-03-04 15:17:47,232 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-03-04 15:17:47,233 - INFO - Директория уже существует: ./video_temp
2025-03-04 15:17:47,233 - INFO - Директория уже существует: ./image_temp
2025-03-04 15:17:47,233 - INFO - Директория уже существует: ./output_video
2025-03-04 15:17:47,233 - INFO - Директория уже существует: ./output_preview
2025-03-04 15:17:47,234 - INFO - Директория уже существует: ./user_logo
2025-03-04 15:17:47,241 - INFO - Задача fetch_and_cache_profiles добавлена в расписание (каждые 5 минут).
2025-03-04 15:17:47,241 - INFO - Задача sync_data_to_db добавлена в расписание (каждые 8 минут).
2025-03-04 15:17:47,241 - INFO - Задача очистки логов добавлена в расписание (каждые 5 минут).
2025-03-04 15:17:47,241 - INFO - Задача очистки временных файлов добавлена в расписание (каждый день в 00:00).
2025-03-04 15:17:47,242 - INFO - Планировщик задач успешно запущен.
2025-03-04 15:18:47,251 - INFO - Открытие сессии с БД...
2025-03-04 15:18:47,257 - INFO - Сессия с БД успешно открыта.
2025-03-04 15:18:47,657 - INFO - Успешно обработано и закэшировано 910 профилей в Redis.
2025-03-04 15:18:47,719 - INFO - Всего публичных профилей в кеше: 488
2025-03-04 15:18:47,719 - INFO - Собрано уникальных профилей по алгоритму: 41
2025-03-04 15:18:47,720 - INFO - Добавляем 9 случайных профилей из оставшихся.
2025-03-04 15:18:47,720 - INFO - Сформировано страниц по алгоритму: 1
2025-03-04 15:18:47,722 - INFO - В кэше размещено 1 страниц.
2025-03-04 15:18:47,722 - INFO - Сформировано и закэшировано 1 страниц из 488 профилей.
2025-03-04 15:18:47,722 - INFO - Закрытие сессии с БД.
2025-03-04 15:19:47,247 - INFO - Открытие сессии с БД...
2025-03-04 15:19:47,252 - INFO - Сессия с БД успешно открыта.
2025-03-04 15:19:47,644 - INFO - Успешно обработано и закэшировано 910 профилей в Redis.
2025-03-04 15:19:47,748 - INFO - Всего публичных профилей в кеше: 488
2025-03-04 15:19:47,748 - INFO - Собрано уникальных профилей по алгоритму: 40
2025-03-04 15:19:47,749 - INFO - Добавляем 10 случайных профилей из оставшихся.
2025-03-04 15:19:47,749 - INFO - Сформировано страниц по алгоритму: 1
2025-03-04 15:19:47,750 - INFO - В кэше размещено 1 страниц.
2025-03-04 15:19:47,750 - INFO - Сформировано и закэшировано 1 страниц из 488 профилей.
2025-03-04 15:19:47,750 - INFO - Закрытие сессии с БД.
2025-03-04 15:20:47,251 - INFO - Открытие сессии с БД...
2025-03-04 15:20:47,257 - INFO - Сессия с БД успешно открыта.
2025-03-04 15:20:47,533 - INFO - Успешно обработано и закэшировано 910 профилей в Redis.
2025-03-04 15:20:47,595 - INFO - Всего публичных профилей в кеше: 488
2025-03-04 15:20:47,595 - INFO - Собрано уникальных профилей по алгоритму: 42
2025-03-04 15:20:47,596 - INFO - Добавляем 8 случайных профилей из оставшихся.
2025-03-04 15:20:47,596 - INFO - Сформировано страниц по алгоритму: 1
2025-03-04 15:20:47,596 - INFO - В кэше размещено 1 страниц.
2025-03-04 15:20:47,597 - INFO - Сформировано и закэшировано 1 страниц из 488 профилей.
2025-03-04 15:20:47,597 - INFO - Закрытие сессии с БД.
2025-03-04 15:21:47,250 - INFO - Открытие сессии с БД...
2025-03-04 15:21:47,255 - INFO - Сессия с БД успешно открыта.
2025-03-04 15:21:47,576 - INFO - Успешно обработано и закэшировано 910 профилей в Redis.
2025-03-04 15:21:47,640 - INFO - Всего публичных профилей в кеше: 488
2025-03-04 15:21:47,641 - INFO - Собрано уникальных профилей по алгоритму: 40
2025-03-04 15:21:47,642 - INFO - Добавляем 10 случайных профилей из оставшихся.
2025-03-04 15:21:47,643 - INFO - Сформировано страниц по алгоритму: 1
2025-03-04 15:21:47,645 - INFO - В кэше размещено 1 страниц.
2025-03-04 15:21:47,646 - INFO - Сформировано и закэшировано 1 страниц из 488 профилей.
2025-03-04 15:21:47,646 - INFO - Закрытие сессии с БД.
2025-03-04 15:22:47,252 - INFO - Открытие сессии с БД...
2025-03-04 15:22:47,257 - INFO - Сессия с БД успешно открыта.
2025-03-04 15:22:47,289 - INFO - Логи старше 10 минут и строки с неправильным форматом удалены из файла video_service.log.
2025-03-04 15:22:47,524 - INFO - Успешно обработано и закэшировано 910 профилей в Redis.
2025-03-04 15:22:47,586 - INFO - Всего публичных профилей в кеше: 488
2025-03-04 15:22:47,587 - INFO - Собрано уникальных профилей по алгоритму: 42
2025-03-04 15:22:47,587 - INFO - Добавляем 8 случайных профилей из оставшихся.
2025-03-04 15:22:47,587 - INFO - Сформировано страниц по алгоритму: 1
2025-03-04 15:22:47,588 - INFO - В кэше размещено 1 страниц.
2025-03-04 15:22:47,588 - INFO - Сформировано и закэшировано 1 страниц из 488 профилей.
2025-03-04 15:22:47,588 - INFO - Закрытие сессии с БД.
2025-03-04 15:23:47,245 - INFO - Открытие сессии с БД...
2025-03-04 15:23:47,249 - INFO - Сессия с БД успешно открыта.
2025-03-04 15:23:47,669 - INFO - Успешно обработано и закэшировано 910 профилей в Redis.
2025-03-04 15:23:47,758 - INFO - Всего публичных профилей в кеше: 488
2025-03-04 15:23:47,759 - INFO - Собрано уникальных профилей по алгоритму: 41
2025-03-04 15:23:47,759 - INFO - Добавляем 9 случайных профилей из оставшихся.
2025-03-04 15:23:47,759 - INFO - Сформировано страниц по алгоритму: 1
2025-03-04 15:23:47,760 - INFO - В кэше размещено 1 страниц.
2025-03-04 15:23:47,761 - INFO - Сформировано и закэшировано 1 страниц из 488 профилей.
2025-03-04 15:23:47,761 - INFO - Закрытие сессии с БД.
2025-03-04 15:24:47,249 - INFO - Открытие сессии с БД...
2025-03-04 15:24:47,254 - INFO - Сессия с БД успешно открыта.
2025-03-04 15:24:47,529 - INFO - Успешно обработано и закэшировано 910 профилей в Redis.
2025-03-04 15:24:47,591 - INFO - Всего публичных профилей в кеше: 488
2025-03-04 15:24:47,592 - INFO - Собрано уникальных профилей по алгоритму: 39
2025-03-04 15:24:47,592 - INFO - Добавляем 11 случайных профилей из оставшихся.
2025-03-04 15:24:47,593 - INFO - Сформировано страниц по алгоритму: 1
2025-03-04 15:24:47,593 - INFO - В кэше размещено 1 страниц.
2025-03-04 15:24:47,593 - INFO - Сформировано и закэшировано 1 страниц из 488 профилей.
2025-03-04 15:24:47,593 - INFO - Закрытие сессии с БД.
2025-03-04 15:24:51,321 - ERROR - Ошибка при получении сообщения: Connection closed by server.
Module: __main__, Function: main, Line: 149
2025-03-04 15:28:43,057 - INFO - Запуск приложения и инициализация базы данных...
2025-03-04 15:28:43,058 - INFO - Запуск подписки на канал Redis для получения задач
2025-03-04 15:28:43,058 - DEBUG - Начало инициализации базы данных...
2025-03-04 15:28:43,086 - INFO - Redis доступен.
2025-03-04 15:28:43,086 - INFO - Подключаемся к Redis...
2025-03-04 15:28:43,087 - INFO - Подписались на канал video_tasks
2025-03-04 15:28:43,201 - INFO - База данных успешно инициализирована.
2025-03-04 15:28:43,201 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-03-04 15:28:43,201 - INFO - Директория уже существует: ./video_temp
2025-03-04 15:28:43,202 - INFO - Директория уже существует: ./image_temp
2025-03-04 15:28:43,202 - INFO - Директория уже существует: ./output_video
2025-03-04 15:28:43,202 - INFO - Директория уже существует: ./output_preview
2025-03-04 15:28:43,202 - INFO - Директория уже существует: ./user_logo
2025-03-04 15:28:43,203 - INFO - Задача fetch_and_cache_profiles добавлена в расписание (каждые 5 минут).
2025-03-04 15:28:43,203 - INFO - Задача sync_data_to_db добавлена в расписание (каждые 11 минут).
2025-03-04 15:28:43,203 - INFO - Задача очистки логов добавлена в расписание (каждые 5 минут).
2025-03-04 15:28:43,203 - INFO - Задача очистки временных файлов добавлена в расписание (каждый день в 00:00).
2025-03-04 15:28:43,204 - INFO - Планировщик задач успешно запущен.
2025-03-04 15:29:17,190 - INFO - Открытие сессии с БД...
2025-03-04 15:29:17,193 - INFO - Сессия с БД успешно открыта.
2025-03-04 15:29:17,656 - INFO - Успешно обработано и закэшировано 910 профилей в Redis.
2025-03-04 15:29:17,719 - INFO - Всего публичных профилей в кеше: 488
2025-03-04 15:29:17,722 - INFO - Собрано уникальных профилей по алгоритму: 45
2025-03-04 15:29:17,723 - INFO - Добавляем 5 случайных профилей из оставшихся.
2025-03-04 15:29:17,723 - INFO - Сформировано страниц по алгоритму: 1
2025-03-04 15:29:17,724 - INFO - В кэше размещено 1 страниц.
2025-03-04 15:29:17,725 - INFO - Сформировано и закэшировано 1 страниц из 488 профилей.
2025-03-04 15:29:17,725 - INFO - Закрытие сессии с БД.
2025-03-04 15:29:17,736 - INFO - Запрошена страница 1. Всего профилей: 488, всего страниц: 1.
2025-03-04 15:29:17,737 - INFO - Получено 50 профилей для страницы 1 из Redis.
2025-03-04 15:29:17,737 - INFO - Показана страница 1 из 1. Профили: 50.
2025-03-04 15:29:21,585 - INFO - Открытие сессии с БД...
2025-03-04 15:29:21,588 - INFO - Сессия с БД успешно открыта.
2025-03-04 15:29:21,922 - INFO - Успешно обработано и закэшировано 910 профилей в Redis.
2025-03-04 15:29:21,979 - INFO - Всего публичных профилей в кеше: 488
2025-03-04 15:29:21,980 - INFO - Собрано уникальных профилей по алгоритму: 45
2025-03-04 15:29:21,980 - INFO - Добавляем 5 случайных профилей из оставшихся.
2025-03-04 15:29:21,981 - INFO - Сформировано страниц по алгоритму: 1
2025-03-04 15:29:21,981 - INFO - В кэше размещено 1 страниц.
2025-03-04 15:29:21,981 - INFO - Сформировано и закэшировано 1 страниц из 488 профилей.
2025-03-04 15:29:21,981 - INFO - Закрытие сессии с БД.
2025-03-04 15:29:21,984 - INFO - Запрошена страница 1. Всего профилей: 488, всего страниц: 1.
2025-03-04 15:29:21,985 - INFO - Получено 50 профилей для страницы 1 из Redis.
2025-03-04 15:29:21,985 - INFO - Показана страница 1 из 1. Профили: 50.
2025-03-04 15:29:23,693 - INFO - Открытие сессии с БД...
2025-03-04 15:29:23,693 - INFO - Сессия с БД успешно открыта.
2025-03-04 15:29:23,935 - INFO - Успешно обработано и закэшировано 910 профилей в Redis.
2025-03-04 15:29:23,996 - INFO - Всего публичных профилей в кеше: 488
2025-03-04 15:29:23,996 - INFO - Собрано уникальных профилей по алгоритму: 44
2025-03-04 15:29:23,997 - INFO - Добавляем 6 случайных профилей из оставшихся.
2025-03-04 15:29:23,997 - INFO - Сформировано страниц по алгоритму: 1
2025-03-04 15:29:23,997 - INFO - В кэше размещено 1 страниц.
2025-03-04 15:29:23,998 - INFO - Сформировано и закэшировано 1 страниц из 488 профилей.
2025-03-04 15:29:23,998 - INFO - Закрытие сессии с БД.
2025-03-04 15:29:24,001 - INFO - Запрошена страница 1. Всего профилей: 488, всего страниц: 1.
2025-03-04 15:29:24,001 - INFO - Получено 50 профилей для страницы 1 из Redis.
2025-03-04 15:29:24,001 - INFO - Показана страница 1 из 1. Профили: 50.
2025-03-04 15:29:27,713 - INFO - Открытие сессии с БД...
2025-03-04 15:29:27,714 - INFO - Сессия с БД успешно открыта.
2025-03-04 15:29:27,978 - INFO - Успешно обработано и закэшировано 910 профилей в Redis.
2025-03-04 15:29:28,040 - INFO - Всего публичных профилей в кеше: 488
2025-03-04 15:29:28,041 - INFO - Собрано уникальных профилей по алгоритму: 45
2025-03-04 15:29:28,042 - INFO - Добавляем 5 случайных профилей из оставшихся.
2025-03-04 15:29:28,042 - INFO - Сформировано страниц по алгоритму: 1
2025-03-04 15:29:28,042 - INFO - В кэше размещено 1 страниц.
2025-03-04 15:29:28,042 - INFO - Сформировано и закэшировано 1 страниц из 488 профилей.
2025-03-04 15:29:28,042 - INFO - Закрытие сессии с БД.
2025-03-04 15:29:28,045 - INFO - Запрошена страница 6. Всего профилей: 488, всего страниц: 1.
2025-03-04 15:29:28,046 - INFO - Получено 50 профилей для страницы 6 из Redis.
2025-03-04 15:29:28,046 - INFO - Показана страница 6 из 1. Профили: 50.
2025-03-04 15:29:36,985 - INFO - Открытие сессии с БД...
2025-03-04 15:29:36,986 - INFO - Сессия с БД успешно открыта.
2025-03-04 15:29:37,245 - INFO - Успешно обработано и закэшировано 910 профилей в Redis.
2025-03-04 15:29:37,306 - INFO - Всего публичных профилей в кеше: 488
2025-03-04 15:29:37,306 - INFO - Собрано уникальных профилей по алгоритму: 45
2025-03-04 15:29:37,307 - INFO - Добавляем 5 случайных профилей из оставшихся.
2025-03-04 15:29:37,307 - INFO - Сформировано страниц по алгоритму: 1
2025-03-04 15:29:37,307 - INFO - В кэше размещено 1 страниц.
2025-03-04 15:29:37,307 - INFO - Сформировано и закэшировано 1 страниц из 488 профилей.
2025-03-04 15:29:37,308 - INFO - Закрытие сессии с БД.
2025-03-04 15:29:37,310 - INFO - Запрошена страница 3. Всего профилей: 488, всего страниц: 1.
2025-03-04 15:29:37,311 - INFO - Получено 50 профилей для страницы 3 из Redis.
2025-03-04 15:29:37,311 - INFO - Показана страница 3 из 1. Профили: 50.
2025-03-04 15:30:06,150 - ERROR - Ошибка при получении сообщения: Connection closed by server.
Module: __main__, Function: main, Line: 149
