2025-03-19 11:52:03,030 - INFO - Запуск подписки на канал Redis для получения задач
2025-03-19 11:52:03,066 - INFO - Redis доступен.
2025-03-19 11:52:03,066 - INFO - Проверка соединения с AWS S3...
2025-03-19 11:52:03,223 - INFO - Запуск приложения и инициализация базы данных...
2025-03-19 11:52:03,223 - DEBUG - Начало инициализации базы данных...
2025-03-19 11:52:03,388 - INFO - База данных успешно инициализирована.
2025-03-19 11:52:03,389 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-03-19 11:52:03,389 - INFO - Директория уже существует: ./video_temp
2025-03-19 11:52:03,389 - INFO - Директория уже существует: ./image_temp
2025-03-19 11:52:03,389 - INFO - Директория уже существует: ./output_video
2025-03-19 11:52:03,390 - INFO - Директория уже существует: ./output_preview
2025-03-19 11:52:03,391 - INFO - Директория уже существует: ./user_logo
2025-03-19 11:52:03,391 - INFO - Директория уже существует: ./user_video_posters
2025-03-19 11:52:03,396 - INFO - Задача fetch_and_cache_profiles добавлена в расписание (каждые 8 минут).
2025-03-19 11:52:03,397 - INFO - Задача sync_data_to_db добавлена в расписание (каждые 8 минут).
2025-03-19 11:52:03,397 - INFO - Задача очистки временных файлов добавлена в расписание (каждый день в 00:00).
2025-03-19 11:52:03,397 - INFO - Планировщик задач успешно запущен.
2025-03-19 11:52:03,654 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-19 11:52:03,655 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-19 11:52:03,656 - INFO - Подключаемся к Redis...
2025-03-19 11:52:03,657 - INFO - Подписались на канал video_tasks
2025-03-19 11:52:42,620 - INFO - Открытие сессии с БД...
2025-03-19 11:52:42,626 - INFO - Сессия с БД успешно открыта.
2025-03-19 11:52:42,654 - INFO - Поиск пользователя в базе данных.
2025-03-19 11:52:42,771 - INFO - Пользователь найден с ID 1
2025-03-19 11:52:42,909 - INFO - Получение избранного через get_favorites_from_cache.
2025-03-19 11:52:42,910 - INFO - Попытка получить избранное из кэша Redis для пользователя 1.
2025-03-19 11:52:42,922 - INFO - Избранное не найдено в кэше для пользователя 1. Загружаем из базы данных.
2025-03-19 11:52:42,922 - INFO - Открытие сессии с БД...
2025-03-19 11:52:42,922 - INFO - Сессия с БД успешно открыта.
2025-03-19 11:52:42,965 - INFO - У пользователя 1 нет избранных профилей.
2025-03-19 11:52:42,965 - INFO - Закрытие сессии с БД.
2025-03-19 11:52:42,965 - INFO - Избранное получено: []
2025-03-19 11:52:42,965 - INFO - Генерация токенов для пользователя.
2025-03-19 11:52:42,967 - INFO - Токены успешно сгенерированы.
2025-03-19 11:52:42,968 - INFO - Закрытие сессии с БД.
2025-03-19 11:55:03,411 - INFO - Открытие сессии с БД...
2025-03-19 11:55:03,415 - INFO - Сессия с БД успешно открыта.
2025-03-19 11:55:03,421 - INFO - Закрытие сессии с БД.
2025-03-19 11:55:03,422 - INFO - Данные о избранном и счетчике подписчиков успешно синхронизированы из кеша в базу данных для всех пользователей.
2025-03-19 11:57:03,403 - INFO - Открытие сессии с БД...
2025-03-19 11:57:03,406 - INFO - Сессия с БД успешно открыта.
2025-03-19 11:57:03,558 - INFO - Успешно обработано и закэшировано 1 профилей в Redis.
2025-03-19 11:57:03,564 - INFO - Собрано уникальных профилей по алгоритму: 1
2025-03-19 11:57:03,564 - INFO - Сформировано страниц: 1
2025-03-19 11:57:03,565 - INFO - В кэше размещено 1 страниц.
2025-03-19 11:57:03,565 - INFO - Сформировано и закэшировано 1 страниц из 1 профилей.
2025-03-19 11:57:03,565 - INFO - Закрытие сессии с БД.
2025-03-19 11:58:03,404 - INFO - Открытие сессии с БД...
2025-03-19 11:58:03,407 - INFO - Сессия с БД успешно открыта.
2025-03-19 11:58:03,423 - INFO - Закрытие сессии с БД.
2025-03-19 11:58:03,425 - INFO - Данные о избранном и счетчике подписчиков успешно синхронизированы из кеша в базу данных для всех пользователей.
2025-03-19 11:58:23,017 - ERROR - Ошибка при получении сообщения: Connection closed by server.
Module: __main__, Function: main, Line: 181
