2025-03-10 21:38:29,562 - INFO - Открытие сессии с БД...
2025-03-10 21:38:29,566 - INFO - Сессия с БД успешно открыта.
2025-03-10 21:38:29,641 - INFO - Закрытие сессии с БД.
2025-03-10 21:38:29,642 - INFO - Данные о избранном и счетчике подписчиков успешно синхронизированы из кеша в базу данных для всех пользователей.
2025-03-10 21:42:29,554 - INFO - Открытие сессии с БД...
2025-03-10 21:42:29,561 - INFO - Сессия с БД успешно открыта.
2025-03-10 21:42:29,587 - INFO - Логи старше 10 минут и строки с неправильным форматом удалены из файла video_service.log.
2025-03-10 21:42:29,833 - INFO - Успешно обработано и закэшировано 912 профилей в Redis.
2025-03-10 21:42:29,879 - INFO - Всего публичных профилей в кеше: 490
2025-03-10 21:42:29,879 - INFO - Собрано уникальных профилей по алгоритму: 44
2025-03-10 21:42:29,880 - INFO - Добавляем 6 случайных профилей из оставшихся.
2025-03-10 21:42:29,880 - INFO - Сформировано страниц: 10
2025-03-10 21:42:29,883 - INFO - В кэше размещено 10 страниц.
2025-03-10 21:42:29,883 - INFO - Сформировано и закэшировано 10 страниц из 490 профилей.
2025-03-10 21:42:29,883 - INFO - Закрытие сессии с БД.
2025-03-10 21:46:29,556 - INFO - Открытие сессии с БД...
2025-03-10 21:46:29,560 - INFO - Сессия с БД успешно открыта.
2025-03-10 21:46:29,636 - INFO - Закрытие сессии с БД.
2025-03-10 21:46:29,636 - INFO - Данные о избранном и счетчике подписчиков успешно синхронизированы из кеша в базу данных для всех пользователей.
2025-03-10 21:47:08,979 - INFO - Открытие сессии с БД...
2025-03-10 21:47:08,981 - INFO - Сессия с БД успешно открыта.
2025-03-10 21:47:09,017 - INFO - Начало хеширования номера кошелька.
2025-03-10 21:47:09,020 - INFO - Хеш номера кошелька: 687e1adfcafc7deae7d01f1279313058c5d41b23d5d92430d84d847ef93e16b9
2025-03-10 21:47:09,020 - INFO - Поиск пользователя в базе данных.
2025-03-10 21:47:09,036 - INFO - Пользователь найден с ID 938
2025-03-10 21:47:09,058 - INFO - Получение избранного через get_favorites_from_cache.
2025-03-10 21:47:09,058 - INFO - Попытка получить избранное из кэша Redis для пользователя 938.
2025-03-10 21:47:09,062 - INFO - Избранное получено из кэша: [7, 6, 98, 76, 155, 56, 157]
2025-03-10 21:47:09,066 - INFO - Найдено 7 профилей в Redis. Отсутствует 0 профилей.
2025-03-10 21:47:09,067 - INFO - Избранное получено: [7, 6, 98, 76, 155, 56, 157]
2025-03-10 21:47:09,067 - INFO - Генерация токенов для пользователя.
2025-03-10 21:47:09,070 - INFO - Токены успешно сгенерированы.
2025-03-10 21:47:09,072 - INFO - Закрытие сессии с БД.
2025-03-10 21:47:29,556 - INFO - Открытие сессии с БД...
2025-03-10 21:47:29,558 - INFO - Сессия с БД успешно открыта.
2025-03-10 21:47:29,587 - INFO - Логи старше 10 минут и строки с неправильным форматом удалены из файла video_service.log.
2025-03-10 21:47:29,882 - INFO - Успешно обработано и закэшировано 912 профилей в Redis.
2025-03-10 21:47:29,988 - INFO - Всего публичных профилей в кеше: 490
2025-03-10 21:47:29,989 - INFO - Собрано уникальных профилей по алгоритму: 44
2025-03-10 21:47:29,990 - INFO - Добавляем 6 случайных профилей из оставшихся.
2025-03-10 21:47:29,990 - INFO - Сформировано страниц: 10
2025-03-10 21:47:29,993 - INFO - В кэше размещено 10 страниц.
2025-03-10 21:47:29,994 - INFO - Сформировано и закэшировано 10 страниц из 490 профилей.
2025-03-10 21:47:29,994 - INFO - Закрытие сессии с БД.
2025-03-10 21:47:51,004 - INFO - Начало обработки запроса для user_id=938, profile_id=6
2025-03-10 21:47:51,008 - INFO - Профиль 6 уже в избранном у пользователя 938
2025-03-10 21:47:51,008 - INFO - Попытка получить избранное из кэша Redis для пользователя 938.
2025-03-10 21:47:51,009 - INFO - Избранное получено из кэша: [7, 6, 98, 76, 155, 56, 157]
2025-03-10 21:47:51,011 - INFO - Найдено 7 профилей в Redis. Отсутствует 0 профилей.
2025-03-10 21:47:51,012 - INFO - Получено количество подписчиков для профиля 6: 4
2025-03-10 21:48:13,943 - ERROR - Ошибка при получении сообщения: Connection closed by server.
Module: __main__, Function: main, Line: 168
