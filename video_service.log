2025-03-30 09:15:12,790 - INFO - Запуск подписки на канал Redis для получения задач
2025-03-30 09:15:12,797 - INFO - Redis доступен.
2025-03-30 09:15:12,797 - INFO - Проверка соединения с AWS S3...
2025-03-30 09:15:13,837 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-30 09:15:13,838 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-30 09:15:13,838 - INFO - Подключаемся к Redis...
2025-03-30 09:15:13,838 - INFO - Подписались на канал video_tasks
2025-03-30 09:15:28,376 - ERROR - Ошибка при получении сообщения: Connection closed by server.
Module: __main__, Function: main, Line: 181
2025-03-30 09:16:32,350 - INFO - Запуск приложения и инициализация базы данных...
2025-03-30 09:16:32,354 - DEBUG - Начало инициализации базы данных...
2025-03-30 09:16:32,447 - INFO - База данных успешно инициализирована.
2025-03-30 09:16:32,447 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-03-30 09:16:32,447 - INFO - Директория уже существует: ./video_temp
2025-03-30 09:16:32,447 - INFO - Директория уже существует: ./image_temp
2025-03-30 09:16:32,447 - INFO - Директория уже существует: ./output_video
2025-03-30 09:16:32,447 - INFO - Директория уже существует: ./output_preview
2025-03-30 09:16:32,447 - INFO - Директория уже существует: ./user_logo
2025-03-30 09:16:32,447 - INFO - Директория уже существует: ./user_video_posters
2025-03-30 09:16:32,451 - INFO - Задача fetch_and_cache_profiles добавлена в расписание (каждые 8 минут).
2025-03-30 09:16:32,451 - INFO - Задача sync_data_to_db добавлена в расписание (каждые 8 минут).
2025-03-30 09:16:32,452 - INFO - Задача очистки временных файлов добавлена в расписание (каждый день в 00:00).
2025-03-30 09:16:32,452 - INFO - Планировщик задач успешно запущен.
2025-03-30 09:16:32,605 - INFO - Запуск подписки на канал Redis для получения задач
2025-03-30 09:16:32,612 - INFO - Redis доступен.
2025-03-30 09:16:32,612 - INFO - Проверка соединения с AWS S3...
2025-03-30 09:16:33,377 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-30 09:16:33,378 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-30 09:16:33,378 - INFO - Подключаемся к Redis...
2025-03-30 09:16:33,378 - INFO - Подписались на канал video_tasks
2025-03-30 09:17:19,206 - INFO - Открытие сессии с БД...
2025-03-30 09:17:19,209 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:17:19,232 - INFO - Поиск пользователя в базе данных.
2025-03-30 09:17:19,267 - INFO - Пользователь не найден, создаем нового.
2025-03-30 09:17:19,300 - INFO - Создан новый пользователь с ID 3
2025-03-30 09:17:19,301 - INFO - Генерация токенов для пользователя.
2025-03-30 09:17:19,303 - INFO - Токены успешно сгенерированы.
2025-03-30 09:17:19,304 - INFO - Закрытие сессии с БД.
2025-03-30 09:17:49,476 - INFO - Получен запрос на загрузку изображения от пользователя с ID: 3
2025-03-30 09:17:49,497 - INFO - Изображение сохранено во временной директории: ./image_temp/9cc7f20d-46cc-4375-977b-401228b60669_молекула_preview_rev_1.png (Размер: 0.09 MB)
2025-03-30 09:17:49,497 - INFO - Изображение успешно загружено: ./image_temp/9cc7f20d-46cc-4375-977b-401228b60669_молекула_preview_rev_1.png
2025-03-30 09:18:17,824 - INFO - Получен запрос на загрузку видео от пользователя с ID: {current_user.user_id}
2025-03-30 09:18:17,868 - INFO - видео сохранено во временной директории: ./video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4 (Размер: 4.65 MB)
2025-03-30 09:18:17,868 - INFO - Видео успешно загружено: ./video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4
2025-03-30 09:19:06,455 - INFO - Получены данные профиля: {'name': 'Кусок ссанины', 'website_or_social': 'https://twitter.com/johndoe', 'activity_hobbies': 'Долбиться в свое очко!', 'hashtags': ['#gaming', '#travel', '#photography'], 'adress': ['123 Example Street, Example City', '456 Another Street, Another City'], 'city': 'Example City', 'coordinates': [(37.7749, -122.4194), (48.8566, 2.3522)], 'is_in_mlm': 1, 'is_incognito': False, 'wallet_number': '0x39b0B8cfa77fA65f36Ad653F649D36EBC7d4475', 'language': None}
2025-03-30 09:19:06,456 - INFO - Получены данные о изображении: {'image_path': './image_temp/9cc7f20d-46cc-4375-977b-401228b60669_молекула_preview_rev_1.png'}
2025-03-30 09:19:06,456 - INFO - Получены данные о видео: {'video_path': './video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4'}
2025-03-30 09:19:06,456 - INFO - Путь к изображению: ./image_temp/9cc7f20d-46cc-4375-977b-401228b60669_молекула_preview_rev_1.png
2025-03-30 09:19:06,456 - INFO - Путь к видео: ./video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4
2025-03-30 09:19:06,457 - INFO - Абсолютный путь к видео: /app/video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4
2025-03-30 09:19:06,457 - INFO - Абсолютный путь к изображению: /app/image_temp/9cc7f20d-46cc-4375-977b-401228b60669_молекула_preview_rev_1.png
2025-03-30 09:19:06,462 - INFO - Изображение перемещено в директорию user_logo: ./user_logo/69304da1-a051-4896-ad43-c29b6fb21597_9cc7f20d-46cc-4375-977b-401228b60669_молекула_preview_rev_1.png (Размер: 0.09 MB)
2025-03-30 09:19:06,462 - INFO - Путь к файлу для сохранения в БД: ./user_logo/69304da1-a051-4896-ad43-c29b6fb21597_9cc7f20d-46cc-4375-977b-401228b60669_молекула_preview_rev_1.png
2025-03-30 09:19:06,462 - INFO - Изображение успешно перемещено в постоянную папку: ./user_logo/69304da1-a051-4896-ad43-c29b6fb21597_9cc7f20d-46cc-4375-977b-401228b60669_молекула_preview_rev_1.png
2025-03-30 09:19:06,462 - INFO - Обработка данных профиля...
2025-03-30 09:19:06,462 - INFO - Соединение с Redis для публикации задачи в канал установлено.
2025-03-30 09:19:06,462 - INFO - Публикуемые данные в Redis: {input_path: /app/video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4, output_path: {'path': './output_video', 'status': 'exists'}, preview_path: {'path': './output_preview', 'status': 'exists'}, user_logo_url: /user_logo/69304da1-a051-4896-ad43-c29b6fb21597_9cc7f20d-46cc-4375-977b-401228b60669_молекула_preview_rev_1.png, wallet_number: 0x39b0B8cfa77fA65f36Ad653F649D36EBC7d4475, form_data: {'name': 'Кусок ссанины', 'website_or_social': 'https://twitter.com/johndoe', 'activity_hobbies': 'Долбиться в свое очко!', 'hashtags': ['#gaming', '#travel', '#photography'], 'adress': ['123 Example Street, Example City', '456 Another Street, Another City'], 'city': 'Example City', 'coordinates': [(37.7749, -122.4194), (48.8566, 2.3522)], 'is_in_mlm': 1, 'is_incognito': False, 'wallet_number': '0x39b0B8cfa77fA65f36Ad653F649D36EBC7d4475', 'language': None}}
2025-03-30 09:19:06,478 - INFO - Задача успешно отправлена в канал video_tasks: {'input_path': '/app/video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4', 'output_path': {'path': './output_video', 'status': 'exists'}, 'preview_path': {'path': './output_preview', 'status': 'exists'}, 'form_data': {'name': 'Кусок ссанины', 'website_or_social': 'https://twitter.com/johndoe', 'activity_hobbies': 'Долбиться в свое очко!', 'hashtags': ['#gaming', '#travel', '#photography'], 'adress': ['123 Example Street, Example City', '456 Another Street, Another City'], 'city': 'Example City', 'coordinates': [(37.7749, -122.4194), (48.8566, 2.3522)], 'is_in_mlm': 1, 'is_incognito': False, 'wallet_number': '0x39b0B8cfa77fA65f36Ad653F649D36EBC7d4475', 'language': None}, 'wallet_number': '0x39b0B8cfa77fA65f36Ad653F649D36EBC7d4475', 'user_logo_url': '/user_logo/69304da1-a051-4896-ad43-c29b6fb21597_9cc7f20d-46cc-4375-977b-401228b60669_молекула_preview_rev_1.png'}
2025-03-30 09:19:06,478 - INFO - Задача успешно отправлена в Redis.
2025-03-30 09:19:06,487 - INFO - Получено сообщение от Redis: {'type': 'message', 'pattern': None, 'channel': 'video_tasks', 'data': '{"input_path": "/app/video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4", "output_path": {"path": "./output_video", "status": "exists"}, "preview_path": {"path": "./output_preview", "status": "exists"}, "form_data": {"name": "\\u041a\\u0443\\u0441\\u043e\\u043a \\u0441\\u0441\\u0430\\u043d\\u0438\\u043d\\u044b", "website_or_social": "https://twitter.com/johndoe", "activity_hobbies": "\\u0414\\u043e\\u043b\\u0431\\u0438\\u0442\\u044c\\u0441\\u044f \\u0432 \\u0441\\u0432\\u043e\\u0435 \\u043e\\u0447\\u043a\\u043e!", "hashtags": ["#gaming", "#travel", "#photography"], "adress": ["123 Example Street, Example City", "456 Another Street, Another City"], "city": "Example City", "coordinates": [[37.7749, -122.4194], [48.8566, 2.3522]], "is_in_mlm": 1, "is_incognito": false, "wallet_number": "0x39b0B8cfa77fA65f36Ad653F649D36EBC7d4475", "language": null}, "wallet_number": "0x39b0B8cfa77fA65f36Ad653F649D36EBC7d4475", "user_logo_url": "/user_logo/69304da1-a051-4896-ad43-c29b6fb21597_9cc7f20d-46cc-4375-977b-401228b60669_\\u043c\\u043e\\u043b\\u0435\\u043a\\u0443\\u043b\\u0430_preview_rev_1.png"}'}
2025-03-30 09:19:06,491 - INFO - Получена задача для обработки: {'input_path': '/app/video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4', 'output_path': {'path': './output_video', 'status': 'exists'}, 'preview_path': {'path': './output_preview', 'status': 'exists'}, 'form_data': {'name': 'Кусок ссанины', 'website_or_social': 'https://twitter.com/johndoe', 'activity_hobbies': 'Долбиться в свое очко!', 'hashtags': ['#gaming', '#travel', '#photography'], 'adress': ['123 Example Street, Example City', '456 Another Street, Another City'], 'city': 'Example City', 'coordinates': [[37.7749, -122.4194], [48.8566, 2.3522]], 'is_in_mlm': 1, 'is_incognito': False, 'wallet_number': '0x39b0B8cfa77fA65f36Ad653F649D36EBC7d4475', 'language': None}, 'wallet_number': '0x39b0B8cfa77fA65f36Ad653F649D36EBC7d4475', 'user_logo_url': '/user_logo/69304da1-a051-4896-ad43-c29b6fb21597_9cc7f20d-46cc-4375-977b-401228b60669_молекула_preview_rev_1.png'}
2025-03-30 09:19:06,491 - INFO - Начинаю конвертацию видео /app/video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4 в VP9
2025-03-30 09:19:06,491 - INFO - Запуск конвертации видео в VP9: /app/video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4 -> ./bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_converted.webm
2025-03-30 09:19:31,283 - INFO - Конвертация в VP9 завершена: ./bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_converted.webm (Размер: 3.39 MB, Время: 24.79 сек.)
2025-03-30 09:19:31,284 - INFO - Видео успешно обработано: ./bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_converted.webm (Размер: 3.39 MB)
2025-03-30 09:19:31,284 - INFO - Путь к конвертированному видео: ./bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_converted.webm
2025-03-30 09:19:31,284 - INFO - Задача конвертации для /app/video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4 завершена успешно
2025-03-30 09:19:31,284 - INFO - Начинаю извлечение превью для /app/video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4
2025-03-30 09:19:31,284 - INFO - Извлечение превью из видео: /app/video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4 -> ./bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_preview.webm (Длительность: 5 сек.)
2025-03-30 09:19:32,466 - INFO - Открытие сессии с БД...
2025-03-30 09:19:32,468 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:19:32,474 - INFO - Закрытие сессии с БД.
2025-03-30 09:19:32,474 - INFO - Данные о избранном и счетчике подписчиков успешно синхронизированы из кеша в базу данных для всех пользователей.
2025-03-30 09:19:39,588 - INFO - Извлечение превью завершено: ./bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_preview.webm (Размер: 1.27 MB, Время: 8.30 сек.)
2025-03-30 09:19:39,588 - INFO - Превью успешно извлечено: ./bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_preview.webm (Размер: 1.27 MB)
2025-03-30 09:19:39,588 - INFO - Путь к извлеченному превью: ./bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_preview.webm
2025-03-30 09:19:39,588 - INFO - Извлечение превью для /app/video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4 завершено успешно
2025-03-30 09:19:39,589 - INFO - Начинаю извлечение постера для /app/video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4
2025-03-30 09:19:39,590 - INFO - Извлечение кадра из видео: ./bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_preview.webm -> user_video_posters/7a1019216f0a46a48ac00c6683b8ee82.jpg (Время: 2 сек.)
2025-03-30 09:19:39,671 - INFO - Извлечение кадра завершено: user_video_posters/7a1019216f0a46a48ac00c6683b8ee82.jpg (Время: 0.08 сек.)
2025-03-30 09:19:39,671 - INFO - Кадр успешно извлечён и сохранён: user_video_posters/7a1019216f0a46a48ac00c6683b8ee82.jpg
2025-03-30 09:19:39,671 - INFO - Извлечение постера для /app/video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4 завершено успешно. Путь: user_video_posters/7a1019216f0a46a48ac00c6683b8ee82.jpg
2025-03-30 09:19:39,671 - INFO - Начинаю загрузку видео {'path': './output_video', 'status': 'exists'} и превью {'path': './output_preview', 'status': 'exists'} в S3
2025-03-30 09:19:40,326 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-30 09:19:40,394 - INFO - Загрузка видео в AWS S3: ./bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_converted.webm -> bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_converted.webm
2025-03-30 09:19:47,345 - INFO - Видео успешно загружено в AWS S3: bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_converted.webm
2025-03-30 09:19:47,345 - INFO - Загрузка превью в AWS S3: ./bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_preview.webm -> bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_preview.webm
2025-03-30 09:19:48,685 - INFO - Превью успешно загружено в AWS S3: bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_preview.webm
2025-03-30 09:19:48,687 - INFO - Загруженные файлы: Видео - https://stt-market-videos.s3.eu-north-1.amazonaws.com/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_converted.webm, Превью - https://stt-market-videos.s3.eu-north-1.amazonaws.com/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_preview.webm
2025-03-30 09:19:48,688 - INFO - Загрузка видео {'path': './output_video', 'status': 'exists'} в S3 завершена успешно. URL: https://stt-market-videos.s3.eu-north-1.amazonaws.com/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_converted.webm
2025-03-30 09:19:48,688 - INFO - Загрузка превью {'path': './output_preview', 'status': 'exists'} в S3 завершена успешно. URL: https://stt-market-videos.s3.eu-north-1.amazonaws.com/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4_preview.webm
2025-03-30 09:19:48,688 - INFO - Начинаю сохранение профиля в БД для пользователя Кусок ссанины
2025-03-30 09:19:48,690 - INFO - Открытие сессии с БД...
2025-03-30 09:19:48,698 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:19:48,890 - INFO - Создан новый профиль с уникальной ссылкой: https://sttore.link/jghd-j4tz-lr4v-m8ct
2025-03-30 09:19:48,901 - INFO - Хэштеги обновлены для профиля 0x39b0B8cfa77fA65f36Ad653F649D36EBC7d4475
2025-03-30 09:19:48,902 - INFO - Данные успешно сохранены для кошелька 0x39b0B8cfa77fA65f36Ad653F649D36EBC7d4475
2025-03-30 09:19:48,903 - INFO - Закрытие сессии с БД.
2025-03-30 09:19:48,903 - INFO - Профиль с именем Кусок ссанины успешно сохранен в БД
2025-03-30 09:19:48,903 - INFO - Весь цикл задач для /app/video_temp/bb71439d-fcd1-44cc-a958-33ed14944960_100236-video-720.mp4 выполнен успешно!
2025-03-30 09:19:48,903 - INFO - Данные задачи очищены.
2025-03-30 09:21:32,458 - INFO - Открытие сессии с БД...
2025-03-30 09:21:32,461 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:21:32,538 - INFO - Успешно обработано и закэшировано 3 профилей в Redis.
2025-03-30 09:21:32,539 - INFO - Собрано уникальных профилей по алгоритму: 3
2025-03-30 09:21:32,539 - INFO - Сформировано страниц: 1
2025-03-30 09:21:32,539 - INFO - В кэше размещено 1 страниц.
2025-03-30 09:21:32,539 - INFO - Сформировано и закэшировано 1 страниц из 3 профилей.
2025-03-30 09:21:32,539 - INFO - Закрытие сессии с БД.
2025-03-30 09:22:04,888 - INFO - Открытие сессии с БД...
2025-03-30 09:22:04,892 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:22:04,897 - INFO - Поиск пользователя в базе данных.
2025-03-30 09:22:04,908 - INFO - Пользователь найден с ID 3
2025-03-30 09:22:04,919 - INFO - Получение избранного через get_favorites_from_cache.
2025-03-30 09:22:04,919 - INFO - Попытка получить избранное из кэша Redis для пользователя 3.
2025-03-30 09:22:04,921 - INFO - Избранное не найдено в кэше для пользователя 3. Загружаем из базы данных.
2025-03-30 09:22:04,921 - INFO - Открытие сессии с БД...
2025-03-30 09:22:04,921 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:22:04,979 - INFO - У пользователя 3 нет избранных профилей.
2025-03-30 09:22:04,979 - INFO - Закрытие сессии с БД.
2025-03-30 09:22:04,980 - INFO - Избранное получено: []
2025-03-30 09:22:04,980 - INFO - Генерация токенов для пользователя.
2025-03-30 09:22:04,982 - INFO - Токены успешно сгенерированы.
2025-03-30 09:22:04,982 - INFO - Закрытие сессии с БД.
2025-03-30 09:22:32,457 - INFO - Открытие сессии с БД...
2025-03-30 09:22:32,462 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:22:32,478 - INFO - Закрытие сессии с БД.
2025-03-30 09:22:32,481 - INFO - Данные о избранном и счетчике подписчиков успешно синхронизированы из кеша в базу данных для всех пользователей.
2025-03-30 09:25:08,554 - ERROR - Ошибка при получении сообщения: Connection closed by server.
Module: __main__, Function: main, Line: 181
2025-03-30 09:26:37,531 - INFO - Запуск приложения и инициализация базы данных...
2025-03-30 09:26:37,531 - DEBUG - Начало инициализации базы данных...
2025-03-30 09:26:37,693 - INFO - База данных успешно инициализирована.
2025-03-30 09:26:37,693 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-03-30 09:26:37,693 - INFO - Директория уже существует: ./video_temp
2025-03-30 09:26:37,693 - INFO - Директория уже существует: ./image_temp
2025-03-30 09:26:37,693 - INFO - Директория уже существует: ./output_video
2025-03-30 09:26:37,693 - INFO - Директория уже существует: ./output_preview
2025-03-30 09:26:37,693 - INFO - Директория уже существует: ./user_logo
2025-03-30 09:26:37,694 - INFO - Директория уже существует: ./user_video_posters
2025-03-30 09:26:37,698 - INFO - Задача fetch_and_cache_profiles добавлена в расписание (каждые 8 минут).
2025-03-30 09:26:37,698 - INFO - Задача sync_data_to_db добавлена в расписание (каждые 8 минут).
2025-03-30 09:26:37,698 - INFO - Задача очистки временных файлов добавлена в расписание (каждый день в 00:00).
2025-03-30 09:26:37,698 - INFO - Планировщик задач успешно запущен.
2025-03-30 09:26:37,771 - INFO - Запуск подписки на канал Redis для получения задач
2025-03-30 09:26:37,781 - INFO - Redis доступен.
2025-03-30 09:26:37,781 - INFO - Проверка соединения с AWS S3...
2025-03-30 09:26:38,537 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-30 09:26:38,538 - INFO - Соединение с AWS S3 установлено успешно.
2025-03-30 09:26:38,538 - INFO - Подключаемся к Redis...
2025-03-30 09:26:38,539 - INFO - Подписались на канал video_tasks
2025-03-30 09:29:37,741 - INFO - Открытие сессии с БД...
2025-03-30 09:29:37,744 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:29:37,754 - INFO - Закрытие сессии с БД.
2025-03-30 09:29:37,754 - INFO - Данные о избранном и счетчике подписчиков успешно синхронизированы из кеша в базу данных для всех пользователей.
2025-03-30 09:31:37,706 - INFO - Открытие сессии с БД...
2025-03-30 09:31:37,710 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:31:37,833 - INFO - Успешно обработано и закэшировано 3 профилей в Redis.
2025-03-30 09:31:37,833 - INFO - Собрано уникальных профилей по алгоритму: 3
2025-03-30 09:31:37,833 - INFO - Сформировано страниц: 1
2025-03-30 09:31:37,834 - INFO - В кэше размещено 1 страниц.
2025-03-30 09:31:37,834 - INFO - Сформировано и закэшировано 1 страниц из 3 профилей.
2025-03-30 09:31:37,834 - INFO - Закрытие сессии с БД.
2025-03-30 09:32:37,704 - INFO - Открытие сессии с БД...
2025-03-30 09:32:37,709 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:32:37,717 - INFO - Закрытие сессии с БД.
2025-03-30 09:32:37,718 - INFO - Данные о избранном и счетчике подписчиков успешно синхронизированы из кеша в базу данных для всех пользователей.
2025-03-30 09:33:49,455 - INFO - Открытие сессии с БД...
2025-03-30 09:33:49,457 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:33:49,485 - INFO - Поиск пользователя в базе данных.
2025-03-30 09:33:49,502 - INFO - Пользователь найден с ID 3
2025-03-30 09:33:49,531 - INFO - Получение избранного через get_favorites_from_cache.
2025-03-30 09:33:49,531 - INFO - Попытка получить избранное из кэша Redis для пользователя 3.
2025-03-30 09:33:49,534 - INFO - Избранное не найдено в кэше для пользователя 3. Загружаем из базы данных.
2025-03-30 09:33:49,534 - INFO - Открытие сессии с БД...
2025-03-30 09:33:49,534 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:33:49,598 - INFO - У пользователя 3 нет избранных профилей.
2025-03-30 09:33:49,598 - INFO - Закрытие сессии с БД.
2025-03-30 09:33:49,608 - INFO - Избранное получено: []
2025-03-30 09:33:49,608 - INFO - Генерация токенов для пользователя.
2025-03-30 09:33:49,621 - INFO - Токены успешно сгенерированы.
2025-03-30 09:33:49,622 - INFO - Закрытие сессии с БД.
2025-03-30 09:34:24,742 - INFO - Открытие сессии с БД...
2025-03-30 09:34:24,744 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:34:24,791 - INFO - Попытка получить избранное из кэша Redis для пользователя 3.
2025-03-30 09:34:24,792 - INFO - Избранное не найдено в кэше для пользователя 3. Загружаем из базы данных.
2025-03-30 09:34:24,792 - INFO - Открытие сессии с БД...
2025-03-30 09:34:24,792 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:34:24,795 - INFO - У пользователя 3 нет избранных профилей.
2025-03-30 09:34:24,795 - INFO - Закрытие сессии с БД.
2025-03-30 09:34:24,795 - INFO - Получено избранное для пользователя 3
2025-03-30 09:34:24,796 - INFO - Закрытие сессии с БД.
2025-03-30 09:34:44,546 - INFO - Открытие сессии с БД...
2025-03-30 09:34:44,548 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:34:44,645 - INFO - Попытка получить избранное из кэша Redis для пользователя 3.
2025-03-30 09:34:44,646 - INFO - Избранное не найдено в кэше для пользователя 3. Загружаем из базы данных.
2025-03-30 09:34:44,646 - INFO - Открытие сессии с БД...
2025-03-30 09:34:44,646 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:34:44,648 - INFO - У пользователя 3 нет избранных профилей.
2025-03-30 09:34:44,648 - INFO - Закрытие сессии с БД.
2025-03-30 09:34:44,649 - INFO - Получено избранное: []
2025-03-30 09:34:44,649 - INFO - Закрытие сессии с БД.
2025-03-30 09:35:04,355 - INFO - Открытие сессии с БД...
2025-03-30 09:35:04,357 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:35:04,379 - INFO - Попытка получить избранное из кэша Redis для пользователя 3.
2025-03-30 09:35:04,381 - INFO - Избранное не найдено в кэше для пользователя 3. Загружаем из базы данных.
2025-03-30 09:35:04,381 - INFO - Открытие сессии с БД...
2025-03-30 09:35:04,381 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:35:04,383 - INFO - У пользователя 3 нет избранных профилей.
2025-03-30 09:35:04,383 - INFO - Закрытие сессии с БД.
2025-03-30 09:35:04,384 - INFO - Получено избранное для пользователя 3
2025-03-30 09:35:04,384 - INFO - Закрытие сессии с БД.
2025-03-30 09:35:37,707 - INFO - Открытие сессии с БД...
2025-03-30 09:35:37,710 - INFO - Сессия с БД успешно открыта.
2025-03-30 09:35:37,717 - INFO - Закрытие сессии с БД.
2025-03-30 09:35:37,718 - INFO - Данные о избранном и счетчике подписчиков успешно синхронизированы из кеша в базу данных для всех пользователей.
2025-03-30 09:35:47,606 - ERROR - Ошибка при получении сообщения: Connection closed by server.
Module: __main__, Function: main, Line: 181
