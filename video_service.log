2025-02-27 11:30:33,491 - INFO - Запуск подписки на канал Redis для получения задач
2025-02-27 11:30:33,560 - INFO - Redis доступен.
2025-02-27 11:30:33,561 - INFO - Подключаемся к Redis...
2025-02-27 11:30:33,561 - INFO - Подписались на канал video_tasks
2025-02-27 11:30:33,601 - INFO - Запуск приложения и инициализация базы данных...
2025-02-27 11:30:33,601 - DEBUG - Начало инициализации базы данных...
2025-02-27 11:30:33,677 - INFO - База данных успешно инициализирована.
2025-02-27 11:30:33,677 - INFO - Приложение успешно запущено. Соединение с базой данных установлено.
2025-02-27 11:30:33,677 - INFO - Директория уже существует: ./video_temp
2025-02-27 11:30:33,677 - INFO - Директория уже существует: ./image_temp
2025-02-27 11:30:33,677 - INFO - Директория уже существует: ./output_video
2025-02-27 11:30:33,677 - INFO - Директория уже существует: ./output_preview
2025-02-27 11:30:33,677 - INFO - Директория уже существует: ./user_logo
2025-02-27 11:30:33,681 - INFO - Задача get_sorted_profiles добавлена в расписание (каждую минуту).
2025-02-27 11:30:33,681 - INFO - Планировщик задач успешно запущен.
2025-02-27 11:30:45,120 - INFO - Открытие сессии с БД...
2025-02-27 11:30:45,123 - INFO - Сессия с БД успешно открыта.
2025-02-27 11:30:45,149 - INFO - Начало хеширования номера кошелька.
2025-02-27 11:30:45,149 - INFO - Хеш номера кошелька: 870481d311cf9c35221d181797fc30af633589968607b4fb8555570efa69dfbf
2025-02-27 11:30:45,149 - INFO - Поиск пользователя в базе данных.
2025-02-27 11:30:45,184 - INFO - Пользователь найден с ID 155
2025-02-27 11:30:45,263 - INFO - Попытка получить избранное из кэша Redis.
2025-02-27 11:30:45,267 - INFO - Retrieved favorites for user 155: [33, 31, 23]
2025-02-27 11:30:45,267 - INFO - Избранное получено из кэша: [33, 31, 23]
2025-02-27 11:30:45,267 - INFO - Генерация токенов для пользователя.
2025-02-27 11:30:45,267 - INFO - Токены успешно сгенерированы.
2025-02-27 11:30:45,268 - INFO - Закрытие сессии с БД.
2025-02-27 11:31:28,978 - INFO - Открытие сессии с БД...
2025-02-27 11:31:28,980 - INFO - Сессия с БД успешно открыта.
2025-02-27 11:31:28,983 - INFO - Начало хеширования номера кошелька.
2025-02-27 11:31:28,983 - INFO - Хеш номера кошелька: fae90fecdd86ee128c54c3df32f20050470d4d069b69e1ca69d1a79d9ed6ff3d
2025-02-27 11:31:28,983 - INFO - Поиск пользователя в базе данных.
2025-02-27 11:31:28,995 - INFO - Пользователь не найден, создаем нового.
2025-02-27 11:31:29,013 - INFO - Создан новый пользователь с ID 477
2025-02-27 11:31:29,013 - INFO - Генерация токенов для пользователя.
2025-02-27 11:31:29,015 - INFO - Токены успешно сгенерированы.
2025-02-27 11:31:29,016 - INFO - Закрытие сессии с БД.
2025-02-27 11:31:33,685 - INFO - Открытие сессии с БД...
2025-02-27 11:31:33,686 - INFO - Сессия с БД успешно открыта.
2025-02-27 11:31:33,777 - INFO - Выбрано и получено 50 профилей.
2025-02-27 11:31:33,781 - INFO - Профили успешно закешированы в Redis.
2025-02-27 11:31:33,781 - INFO - Закрытие сессии с БД.
2025-02-27 11:32:33,690 - INFO - Открытие сессии с БД...
2025-02-27 11:32:33,695 - INFO - Сессия с БД успешно открыта.
2025-02-27 11:32:33,764 - INFO - Выбрано и получено 50 профилей.
2025-02-27 11:32:33,771 - INFO - Профили успешно закешированы в Redis.
2025-02-27 11:32:33,771 - INFO - Закрытие сессии с БД.
2025-02-27 11:32:55,424 - INFO - Получен запрос на загрузку изображения от пользователя с ID: 477
2025-02-27 11:32:55,435 - INFO - Изображение сохранено во временной директории: ./image_temp/3034d80a-d7f0-47e0-986f-b001a92c0fe8_orig_cat.webp (Размер: 0.07 MB)
2025-02-27 11:32:55,435 - INFO - Изображение успешно загружено: ./image_temp/3034d80a-d7f0-47e0-986f-b001a92c0fe8_orig_cat.webp
2025-02-27 11:33:24,624 - INFO - Открытие сессии с БД...
2025-02-27 11:33:24,626 - INFO - Сессия с БД успешно открыта.
2025-02-27 11:33:24,630 - INFO - Получены данные профиля: {'name': 'Ебобо ЕЩЕ Какой', 'website_or_social': 'https://twitter.com/johndoe', 'activity_hobbies': 'Gaming, Traveling', 'hashtags': ['#Долбиться в очко'], 'adress': ['123 Example Street, Example City', '456 Another Street, Another City'], 'city': 'Хуепутальск', 'coordinates': [(55.783, 37.65)], 'is_in_mlm': 1, 'is_incognito': False, 'wallet_number': '0x53b9B8cfa28fA93f66Ad574F770D86EBC2d4755', 'language': None}
2025-02-27 11:33:24,630 - INFO - Получены данные о изображении: {'image_path': './image_temp/3034d80a-d7f0-47e0-986f-b001a92c0fe8_orig_cat.webp'}
2025-02-27 11:33:24,630 - INFO - Номер кошелька захэширован: fae90fecdd86ee128c54c3df32f20050470d4d069b69e1ca69d1a79d9ed6ff3d
2025-02-27 11:33:24,630 - INFO - Путь к изображению: ./image_temp/3034d80a-d7f0-47e0-986f-b001a92c0fe8_orig_cat.webp
2025-02-27 11:33:24,631 - INFO - Абсолютный путь к изображению: /app/image_temp/3034d80a-d7f0-47e0-986f-b001a92c0fe8_orig_cat.webp
2025-02-27 11:33:24,634 - INFO - Изображение перемещено в директорию user_logo: ./user_logo/a167acfe-e5a0-4f1a-a7b5-bf8e3d196c03_3034d80a-d7f0-47e0-986f-b001a92c0fe8_orig_cat.webp (Размер: 0.07 MB)
2025-02-27 11:33:24,634 - INFO - Путь к файлу для сохранения в БД: ./user_logo/a167acfe-e5a0-4f1a-a7b5-bf8e3d196c03_3034d80a-d7f0-47e0-986f-b001a92c0fe8_orig_cat.webp
2025-02-27 11:33:24,635 - INFO - Изображение успешно перемещено в постоянную папку: ./user_logo/a167acfe-e5a0-4f1a-a7b5-bf8e3d196c03_3034d80a-d7f0-47e0-986f-b001a92c0fe8_orig_cat.webp
2025-02-27 11:33:24,715 - INFO - Создан профиль для пользователя 477
2025-02-27 11:33:24,718 - INFO - Хэштеги добавлены/обновлены для профиля пользователя 477
2025-02-27 11:33:24,721 - INFO - Закрытие сессии с БД.
2025-02-27 11:33:33,689 - INFO - Открытие сессии с БД...
2025-02-27 11:33:33,693 - INFO - Сессия с БД успешно открыта.
2025-02-27 11:33:33,757 - INFO - Выбрано и получено 50 профилей.
2025-02-27 11:33:33,763 - INFO - Профили успешно закешированы в Redis.
2025-02-27 11:33:33,763 - INFO - Закрытие сессии с БД.
2025-02-27 11:33:55,870 - INFO - Открытие сессии с БД...
2025-02-27 11:33:55,871 - INFO - Сессия с БД успешно открыта.
2025-02-27 11:33:55,872 - INFO - Запрос профилей для города: Хуепутальск", страница: 1, сортировка: None, профилей на странице: 25
2025-02-27 11:33:55,891 - INFO - Получено 0 профилей для страницы 1
2025-02-27 11:33:55,891 - INFO - Закрытие сессии с БД.
2025-02-27 11:34:32,242 - INFO - Открытие сессии с БД...
2025-02-27 11:34:32,243 - INFO - Сессия с БД успешно открыта.
2025-02-27 11:34:32,247 - INFO - Запрос профилей для города: Хуепутальск, страница: 1, сортировка: None, профилей на странице: 25
2025-02-27 11:34:32,268 - INFO - Получено 1 профилей для страницы 1
2025-02-27 11:34:32,268 - INFO - Закрытие сессии с БД.
2025-02-27 11:34:33,688 - INFO - Открытие сессии с БД...
2025-02-27 11:34:33,689 - INFO - Сессия с БД успешно открыта.
2025-02-27 11:34:33,731 - INFO - Выбрано и получено 50 профилей.
2025-02-27 11:34:33,734 - INFO - Профили успешно закешированы в Redis.
2025-02-27 11:34:33,734 - INFO - Закрытие сессии с БД.
2025-02-27 11:34:41,272 - ERROR - Ошибка при получении сообщения: Connection closed by server.
2025-02-27 11:34:41,280 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,281 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,281 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,282 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,283 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,284 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,285 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,286 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,289 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,291 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,297 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,300 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,302 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,303 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,306 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,307 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,308 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,309 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,309 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,311 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,312 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,313 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,314 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,315 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,316 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,318 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,319 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,320 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,321 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,322 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,323 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,323 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
2025-02-27 11:34:41,324 - ERROR - Ошибка при получении сообщения: Error 111 connecting to redis:6379. Connect call failed ('172.19.0.5', 6379).
