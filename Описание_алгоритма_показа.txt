2. Алгоритм подбора

    Разделяем профили на категории:
        Новые профили (например, созданные за последние 24–48 часов).
        Популярные профили (например, с лайками выше медианного значения).
        Обычные профили (не новые и не популярные).

    Смешиваем профили с определенной вероятностью:
        50% — популярные профили.
        30% — новые профили.
        20% — обычные профили.

    Случайная выдача из каждой категории:
        Внутри категории профили выбираются случайным образом, но с учетом веса. Например:
            У нового профиля вес = 100 - (часы с момента создания).
            У популярного профиля вес = лайки / медианное значение лайков.

3. Обновление весов

Для корректной работы нужно регулярно пересчитывать веса:

    Популярность может измениться (например, новый профиль набрал лайки и стал популярным).
    Новизна профиля уменьшается со временем.

Это можно сделать:

    В рамках задачи по обновлению кэша (например, раз в час).
    С использованием фоновых задач (например, Celery).

Пример потока работы

    Кэшируем популярные профили:
        В Redis храним топ-100 профилей с максимальным количеством лайков:
            Ключ: popular_profiles.
            Значения: список profile_id.

    Кэшируем новые профили:
        В Redis храним топ-100 новых профилей:
            Ключ: new_profiles.
            Значения: список profile_id.

    Отдаем профили в миксе:
        Когда пользователь делает запрос, выбираем:
            5 популярных профилей.
            3 новых профиля.
            2 обычных профиля.
        Возвращаем их в случайном порядке, чтобы лента выглядела естественно.

    Дополняем ленивую загрузку:
        При достижении конца текущего списка лента подгружает новые порции:
            Следующие 5 популярных.
            Следующие 3 новых.
            Следующие 2 обычных.

Как это предотвратит проблему "заглохшего" видео?

    Новые профили всегда видны:
    Они появляются в ленте благодаря системе весов, даже если лайков пока мало.
    Старые профили не забываются:
    Устаревшие профили периодически показываются в категории обычных.
    Популярные профили получают внимание:
    Если профиль набирает много лайков, он становится более видимым.